aln:
  id: "aln://bithub/compliance"
  version: "1.0.0"

required:
  permissions:
    contents: read
  compliance_job: true
  needs_compliance: true
  manifests:
    - ".bit/patterns/universally_adaptable_ml.patterns.aln.bit"
  lisp_verify: true
  policies_dir: ".bithub/policies"
  ledger_path: ".bithub/ledger/compliance.log"

forbid:
  run_pipes_regex: "(?i)(curl|wget).+\\|.+bash"
  backslash_in_workflows: true

actions:
  safelist:
    - "actions/checkout@v4"
    - "actions/cache@v4"
    - "actions/setup-dotnet@v3.4.2"
    - "actions/setup-java@v5"
    - "actions/setup-node@v4"
    - "actions/setup-python@v5"
    - "actions/upload-artifact@v4"
    - "./.github/actions/bithub-compliance-gate"
  replace_map:
    "actions/checkout@v2": "actions/checkout@v4"
    "actions/checkout@v3": "actions/checkout@v4"
    "actions/upload-artifact@v3": "actions/upload-artifact@v4"
    "actions/setup-java@v3": "actions/setup-java@v5"
    "actions/setup-node@v2": "actions/setup-node@v4"
    "actions/setup-python@v2": "actions/setup-python@v5"
    "actions/setup-dotnet@v2": "actions/setup-dotnet@v3.4.2"
  wildcard_map:
    - from: "thirdparty/cache@*"
      to: "actions/cache@v4"
  fallback_safe_action: "actions/checkout@v4"

autopatch:
  enable: true
  add_permissions_if_missing: true
  add_compliance_job_if_missing: true
  add_needs_compliance: true
  swap_disallowed_actions: true
  block_run_pipes: true
