import{r as u,R as g,j as e,f as k,l as W}from"./vendors-CICR9AUe.js";import{m as kt,g as _t,c as Ct,E as Mt,s as St,h as It,C as es,A as Pt}from"./CodeStep-AXT-wiPY.js";import{G as Oe}from"./GeneratedVideoCard-UznAkFw7.js";import{u as S,a as Rt}from"./i18n-BkEVeW0K.js";import{j as O,k4 as Z,sU as re,k as oe,X as Et,de as Tt,sV as we,sW as ye,q4 as xe,ot as ee,er as At,b,e7 as I,af as ss,o as fe,al as se,T as x,iB as Dt,g0 as U,d7 as ie,d8 as q,dg as ts,a5 as te,m as as,a1 as ce,$ as le,E as Y,mW as Bt,ps as Lt,dn as ls,dX as ns,gD as F,gg as Te,gZ as Ae,g_ as rs,g$ as is,h3 as Me,py as zt,se as Ft,pL as Ht,h4 as We,h2 as $t,h5 as Ot,dU as Ue,aK as Wt,cL as De,i as Ut,B as he,a3 as Gt,sX as Vt,hh as os,hf as qt,hi as Yt,gW as Ne,hI as Ge,kJ as Kt,bb as Jt,u as Zt,sY as Xt,sZ as Qt,ay as ea,s_ as sa,s$ as ta,t0 as aa,sI as la,sk as na,pu as cs,aG as ra,t1 as ia,t2 as oa,nW as ca,eu as da,eL as ua,f as ma,sj as ha,t3 as X,gz as xa,sH as fa,dk as pa}from"./index--pt7q6eW.js";import{aw as ga,az as ds,A as us,T as $,aB as ms,f as pe,fq as va,u as ja,t as Be,z as Se,c as hs,fr as ba,a8 as wa,b9 as ya,e6 as Na,X as ka,l as _a}from"./icons-Babbxpm-.js";import{I as xs,P as fs,a as Ca,b as Ma}from"./PlaceInlineCard-cly7xmPK.js";import{L as Q,l as ps,$ as ge,a2 as T}from"./platform-FbNS7mVX.js";import{M as H}from"./MarkdownResponse-CqwzVtP4.js";import{C as gs}from"./CardCarouselV2-Buas1iJ9.js";import{a as ve,b as de,V as ue,I as Sa}from"./ImagesModePreview-DDWD6O4K.js";import{u as Le,g as Ia}from"./useGenerateShoppingReviewSummary-2hIpw4tq.js";import{a as me,I as Ve}from"./ImagePagedCarousel-jcCHCK1p.js";import{a as qe,E as vs,G as js,F as Pa,H as Ra,k as ke,g as Ea,J as Ta,o as Aa,K as Da,n as Ba,L as _e,P as La}from"./utils-DnuCK6_Y.js";import za from"./TimeAgoTooltip-D_lPRjUp.js";import{ResponsiveAppAsset as Fa}from"./AppsMode-CKdCn3k5.js";const Ha=(s,a)=>{const t=u.useRef(!1),{trackEventOnce:l}=O();u.useEffect(()=>{if(!s.current||!a)return;const i=new IntersectionObserver(n=>{for(const r of n)r.isIntersecting&&!t.current&&(l("inline image viewed",{image_url:a}),t.current=!0,i.disconnect())},{threshold:.1});return i.observe(s.current),()=>{i.disconnect()}},[s,a,l])},bs=g.memo(({image:{...s},entryUUID:a})=>{const[t,l]=u.useState(!1),i=u.useRef(null),{isMobileStyle:n}=oe(),{$t:r}=S(),{trackEventOnce:o}=O(),{openToast:c}=Et(),{trackEvent:d}=O();Ha(i,s.image||s.thumbnail);const m=!Tt(s.url)&&!we(s.url)&&!re(s.url)&&!ye(s.url);xe({assetType:re(s.url)?ee.CHART:ee.GENERATED_IMAGE,entryUUID:a,answerMode:"search",reason:"inline-images-card",skip:!we(s.url)&&!ye(s.url)&&!re(s.url)}),s.name&&(s.name=s.name.trim().replace(/\.+$/,""));const p=u.useCallback(()=>{o("inline image reported",{image_url:s.image||s.thumbnail}),c(r({defaultMessage:"Image reported",id:"1AlPn3tPyf"}),"success",3)},[r,s.image,s.thumbnail,c,o]),h=u.useCallback(async()=>{const R=await(await fetch(s.image)).blob();At(document.body,"image.png",R);let E;we(s.url)||ye(s.url)?E=ee.GENERATED_IMAGE:re(s.url)&&(E=ee.CHART),E&&d("generated asset downloaded",{assetType:E,answerMode:"search",entryUUID:a,reason:"inline-images-card"})},[s.image,a,d,s.url]),f=u.useMemo(()=>({aspectRatio:s.image_width/s.image_height}),[s.image_height,s.image_width]),v=u.useCallback(()=>l(!0),[]),_=u.useCallback(()=>l(!1),[]),j=u.useMemo(()=>({url:s.url,showCitation:m}),[s.url,m]),C=u.useMemo(()=>[{type:"default",text:r({defaultMessage:"Download",id:"5q3qC0sC3r"}),icon:ga,onClick:h},{type:"default",text:r({defaultMessage:"Report",id:"x5Tz6MZH82"}),icon:ds,onClick:p}],[r,h,p]);return e.jsxs(b,{className:"my-6 overflow-hidden",ref:i,children:[e.jsxs(I,{fullBleed:!0,className:"group relative w-full overflow-hidden",style:f,children:[e.jsx("div",{className:k("absolute right-4 top-4 z-10 opacity-0 transition-opacity duration-300 group-hover:opacity-100",{"!opacity-100":t||n}),onClick:M=>{M.stopPropagation()},children:e.jsx(ss,{isMobileStyle:n,items:C,onOpen:v,onClose:_,children:e.jsx(fe,{extraCSS:"bg-black/30 !text-white backdrop-blur-sm",variant:"noHover",pill:!0,size:"tiny",icon:us})})}),e.jsx(se,{src:s.image||s.thumbnail,alt:s.name||"",origin:j,containerClassName:"size-full",maskClassName:"size-full [&>img]:max-h-[unset]",imageClassName:"size-full object-cover",includeLightBoxModal:!0,onDownload:h})]}),s.name&&e.jsx("div",{className:"pt-sm leading-tight",children:e.jsxs("span",{children:[e.jsx(x,{variant:"small",as:"span",children:s.name}),e.jsx(x,{variant:"small",color:"light",as:"span",children:m&&e.jsxs(e.Fragment,{children:["Â ",e.jsx(Dt,{url:s.url})]})})]})})]})},({image:s,...a},{image:t,...l})=>U(a,l)&&W(s,t));bs.displayName="InlineImagesCardInner";const ws=g.memo(({image:s,searchMode:a,entryUUID:t})=>a===Z.RESEARCH||a===Z.STUDIO||a===Z.SEARCH&&re(s.url)?e.jsx(bs,{image:s,entryUUID:t}):null);ws.displayName="InlineImagesCard";function $a({knowledgeCard:s,entryUUID:a,type:t}){const{trackEventOnce:l,trackEvent:i}=O();l("knowledge card shown",{entryUUID:a??"",type:t,name:s.title,id:s.id});const n=u.useCallback(({label:o,value:c})=>{i("knowledge card clicked",{entryUUID:a??"",type:t,name:s.title,id:s.id,label:o,value:c??""})},[i,a,t,s.title,s.id]),r=u.useCallback((o,c)=>()=>{n({label:o,value:typeof c=="function"?c():c})},[n]);return u.useMemo(()=>({trackClick:n,createClickHandler:r}),[n,r])}const ys=s=>{if(!s)return s;if(/^https?:\/\/(www\.)?imdb\.com/i.test(s)){const t=s.includes("?")?"&":"?";return`${s}${t}ref_=ref_ext_perplexity`}return s},ze=g.memo(({knowledgeCard:s,handleAddToFollowup:a,entryUUID:t})=>{const[l,i]=u.useState(!1),{trackClick:n,createClickHandler:r}=$a({knowledgeCard:s,entryUUID:t,type:"MOVIE"}),{$t:o}=S(),c=u.useMemo(()=>r("title",()=>s.links[0]?.url),[r,s.links]),d=u.useMemo(()=>r("watchOn","tile"),[r]),m=u.useCallback(y=>n({label:"watchOn",value:y}),[n]),p=u.useMemo(()=>r("ratings","tile"),[r]),h=u.useMemo(()=>r("poster","image"),[r]),f=u.useCallback(y=>n({label:"attributes",value:y}),[n]),v=s.attributes.find(y=>y.key==="duration")?.values[0]?.value,_=s.attributes.find(y=>y.key==="release_year")?.values[0]?.value,j=s.attributes.find(y=>y.key==="genres")?.values,C=s.attributes.find(y=>y.key==="trailer")?.values[0]?.value,M=s.attributes.find(y=>y.key==="image_url")?.values[0]?.value,R=s.attributes.find(y=>y.key==="image_url_orig")?.values[0]?.value,E=s.attributes.find(y=>y.key==="trailer_preview_url")?.values[0]?.value,N=s.attributes.find(y=>y.key==="certificate")?.values[0]?.value,w=s.attributes.find(y=>y.key==="ratings")?.values,B=s.attributes.find(y=>y.key==="watch_on")?.values,L=s.attributes.find(y=>y.key==="future_release_date"),A=L?.values[0]?.value,G=L?.title,ae=y=>y.filter(({key:K})=>K==="directed_by"||K==="starring").flatMap(({key:K,title:J,values:D})=>D.map(z=>({...z,title:J,type:K})));return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"gap-md @container mt-4 flex flex-col",children:[e.jsxs("div",{className:"gap-xs flex flex-col",children:[e.jsx(xs,{title:s.title,href:ys(s.links[0].url),linkType:"external",noFollow:!0,onClick:c}),e.jsx("div",{children:e.jsxs(ie,{className:"gap-xs flex flex-row flex-wrap",children:[N&&e.jsx(q,{id:"rating",children:e.jsx("div",{className:"px-xs after:border-foreground after:-translate-y-half relative w-fit after:absolute after:inset-0 after:block after:rounded after:border after:opacity-50 after:content-['']",children:e.jsx(x,{variant:"tiny",color:"light",children:N})})}),(_||A)&&e.jsx(q,{id:"year",children:e.jsx(x,{variant:"smallBold",color:"light",children:A?G?G+" "+A:o({defaultMessage:"Premieres ",id:"ELpawAlvj0"})+A:_})}),j&&j.length>0&&e.jsx(q,{id:"genre",children:e.jsx(x,{variant:"smallBold",color:"light",children:j.slice(0,2).map(y=>y.value).join(", ")})}),v&&e.jsx(q,{id:"duration",children:e.jsx(x,{variant:"smallBold",color:"light",children:v})})]})})]}),e.jsxs("div",{className:"gap-sm @[600px]:grid-cols-[17%_46%_1fr] @[700px]:grid-cols-[120px_320px_1fr] grid grid-cols-[26.8%_1fr]",children:[e.jsx(I,{as:"button",fullBleed:!0,className:"aspect-[4/6] w-full overflow-hidden",onClick:h,children:M?e.jsx(se,{src:M,lightboxSrc:R??M,alt:s.title+" poster",imageClassName:"size-full object-cover",containerClassName:"size-full object-cover",className:"absolute inset-0 size-full object-cover"}):e.jsx("div",{className:"bg-offset size-full"})}),e.jsx(I,{as:"button",fullBleed:!0,onClick:C?()=>i(!0):void 0,className:"group relative size-full overflow-hidden",children:E?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:E,alt:s.title+" trailer",className:"absolute inset-0 size-full object-cover"}),e.jsx("div",{className:"absolute left-1/2 top-1/2 flex size-12 -translate-x-1/2 -translate-y-1/2 items-center justify-center rounded-full bg-black/50 backdrop-blur-sm backdrop-saturate-200",children:e.jsx(x,{variant:"smallBold",color:"white",className:"group-active:opacity-70",children:e.jsx($,{icon:ms})})})]}):e.jsx("div",{className:"bg-offset size-full"})}),e.jsx("div",{className:"gap-sm @[600px]:h-full @[600px]:col-span-1 col-span-full flex h-[124px] w-full flex-col",children:e.jsx(Ns,{handleAddToFollowup:a,data:ae(s.attributes),watchOn:B||void 0,ratings:w||void 0,onWatchOnClick:d,onWatchOnLinkClick:m,onRatingsClick:p,onAttributeClick:f})})]})]})}),C&&e.jsx(ts,{name:s.title,url:C??"",isOpen:l,setisOpen:i})]})});ze.displayName="MovieInlineCard";const Ns=g.memo(({data:s,handleAddToFollowup:a,watchOn:t,ratings:l,onWatchOnClick:i,onWatchOnLinkClick:n,onRatingsClick:r,onAttributeClick:o})=>{const[c,d]=u.useState(!1),[m,p]=u.useState(1),[h,f]=u.useState(1),[v,{width:_,height:j}]=te(),[C,M]=u.useState(0),[R,E]=u.useState("WHERE_TO_WATCH"),N=u.useRef(null),w=(()=>{const D=t&&t.length>0,z=l&&l.length>0;return D&&z?2:D||z?1:0})(),B=Math.floor(_??0),L=Math.floor(j??0);u.useEffect(()=>{const D=z=>{N.current&&!N.current.contains(z.target)&&!z.target.closest('[data-id="movie-attribute-grid"]')&&d(!1)};return document.addEventListener("click",D),()=>{document.removeEventListener("click",D)}},[]);const A=u.useCallback((D,z,be,V)=>{const yt=Math.floor(D/be),Nt=Math.floor(z/V);return{columns:Math.max(1,yt),rows:Math.max(1,Nt)}},[]),G=D=>{switch(D){case"WHERE_TO_WATCH":return e.jsx(Ms,{watchOn:t,onLinkClick:n});case"RATINGS":return e.jsx(Ps,{ratings:l});case"CAST":return e.jsx(Rs,{cast:s,handleAddToFollowup:a});default:return null}};u.useEffect(()=>{const{columns:D,rows:z}=A(B,L,200,56);p(D),f(z)},[B,L,A]),u.useEffect(()=>{const D=t||l?Math.max(0,h*m-w):h*m;M(Math.min(D,s.length))},[h,m,t,l,w,s.length]);const ae=u.useCallback(()=>{r?.(),d(!0),E("RATINGS")},[r]),y=u.useCallback(()=>{d(!0),E("WHERE_TO_WATCH")},[]),K=u.useCallback(()=>{d(!0),E("CAST")},[]),J=u.useCallback(()=>{d(!0),E("FUTURE_RELEASE_DATE")},[]);return e.jsx("div",{ref:N,"data-id":"movie-attribute-grid",className:"size-full",style:{transformStyle:"preserve-3d",perspective:"1000px"},children:e.jsxs(as.div,{initial:{rotateY:0},animate:{rotateY:c?180:0},transition:{type:"spring",stiffness:200,damping:30},style:{willChange:"transform",transformStyle:"preserve-3d"},className:"relative size-full",children:[e.jsxs("div",{ref:v,className:"gap-sm grid size-full",style:{gridTemplateColumns:`repeat(${m}, 1fr)`,gridTemplateRows:`repeat(${h}, 1fr)`,backfaceVisibility:"hidden"},children:[l&&e.jsx(ks,{ratings:l,onClick:ae}),t&&e.jsx(Cs,{watchOn:t,onClick:y,onWatchOnClick:i}),[...Array(C)].map((D,z)=>e.jsx(_s,{person:s[z],onClick:s[z]?.type==="future_release_date"?J:K,onAttributeClick:o},z))]}),e.jsx("div",{className:k("absolute inset-0 size-full",{"z-10":c}),style:{backfaceVisibility:"hidden",willChange:"transform",transform:"rotateY(180deg)"},children:e.jsxs(I,{className:"size-full",children:[e.jsx("button",{className:"shadow-overlay active:bg-offset absolute right-[-8px] top-[-8px] z-[1] flex size-[24px] items-center justify-center rounded-full bg-white dark:bg-black",onClick:D=>{D.stopPropagation(),d(!1)},children:e.jsx(x,{color:"light",children:e.jsx($,{icon:pe,size:"sm"})})}),G(R)]})})]})})});Ns.displayName="MovieAttributeGrid";const ks=g.memo(({ratings:s,onClick:a})=>{const{$t:t}=S(),[l,{width:i}]=te();return e.jsx(I,{onClick:a,className:"px-md active:bg-offset dark:active:bg-offsetPlus flex size-full cursor-pointer flex-col justify-center",children:e.jsxs("div",{className:"gap-sm grid grid-cols-[auto_1fr] items-center",children:[e.jsx("div",{children:e.jsx(x,{variant:"smallBold",color:"default",children:t({defaultMessage:"Ratings",id:"XYovs/iySe"})})}),e.jsx("div",{className:"relative h-7",children:e.jsx("div",{ref:l,className:"absolute inset-0 flex flex-row items-center justify-end gap-3 overflow-hidden",children:s.slice(0,i>148?2:1).map(n=>{const r=n.value.split(" ")[0];return e.jsxs("div",{className:"flex flex-row items-center gap-1.5",children:[e.jsx(x,{variant:"small",color:"light",className:"whitespace-nowrap",children:r}),e.jsxs("div",{className:"empty:bg-offset relative aspect-square w-6 shrink-0 overflow-hidden rounded-full",children:[e.jsx("div",{className:"rounded-inherit pointer-events-none absolute inset-0 z-[1] border border-[black]/5 dark:border-[white]/5"}),e.jsx(ce,{hideBorder:!0,size:24,domain:n.source,overrideIconUrl:n.detail,className:"size-full"})]})]},n.value)})})})]})})});ks.displayName="RatingTile";const _s=g.memo(({person:s,onClick:a,onAttributeClick:t})=>{const l=s.type==="future_release_date",i=u.useCallback(()=>{s&&(t?.(s.type||"cast"),a?.())},[s,t,a,l]);return e.jsx(I,{onClick:i,className:k("px-md active:bg-offset dark:active:bg-offsetPlus flex size-full cursor-pointer flex-col justify-center"),children:e.jsxs("div",{className:"grid",children:[e.jsx(x,{variant:"tinyRegular",color:"light",children:s.title}),e.jsx(x,{variant:"smallBold",color:"default",className:"truncate",children:s.value})]})})});_s.displayName="PersonTile";const Cs=g.memo(({watchOn:s,onClick:a,onWatchOnClick:t})=>{const{$t:l}=S(),[i,{width:n,height:r}]=te(),[o,c]=u.useState(0),d=u.useCallback(()=>{t?.(),a()},[t,a]),m=u.useCallback((p,h,f)=>{const v=Math.floor((p+f)/(h+f));return Math.max(0,v)},[]);return u.useEffect(()=>{const p=m(n??0,28,-6);c(p)},[n,r,m]),e.jsx(I,{onClick:d,className:"px-md active:bg-offset dark:active:bg-offsetPlus group flex size-full cursor-pointer flex-col justify-center",children:e.jsxs("div",{className:"gap-md grid grid-cols-[auto_1fr] items-center",children:[e.jsxs("div",{children:[e.jsx(x,{variant:"tinyRegular",color:"light",className:"whitespace-nowrap",children:l({defaultMessage:"Watch on",id:"hFKSw/9pDA"})}),e.jsxs(x,{variant:"smallBold",color:"default",className:"whitespace-nowrap",children:[s[0].value,s.length>1&&`, +${s.length-1}`]})]}),e.jsx("div",{ref:i,className:"relative size-full h-7",children:e.jsx("div",{className:"absolute inset-0 flex flex-row justify-end",children:s.slice(0,Math.min(o,3)).map((p,h)=>e.jsxs("div",{className:"group-active:border-subtlest dark:border-subtlest dark:group-active:border-subtlest border-subtlest last:-mr-two relative -mr-1.5 box-content aspect-square w-6 shrink-0 overflow-hidden rounded-full border-2 bg-white",style:{zIndex:s.length-h},children:[e.jsx("div",{className:"rounded-inherit pointer-events-none absolute inset-0 z-[1] border border-[black]/5 dark:border-[white]/5"}),e.jsx(ce,{hideBorder:!0,size:24,domain:p.source,overrideIconUrl:p.detail,className:"size-full"})]},h))})})]})})});Cs.displayName="WatchOnTile";const Ms=g.memo(({watchOn:s,onLinkClick:a})=>{const{$t:t}=S();return e.jsx("div",{className:"scrollbar-none size-full overflow-y-scroll",children:e.jsxs("div",{className:"p-md pb-sm gap-sm flex flex-col text-left",children:[e.jsx(x,{variant:"smallBold",className:"leading-tight",color:"default",children:t({defaultMessage:"Watch on",id:"hFKSw/9pDA"})}),s&&s.length>0&&e.jsx(Is,{watchOn:s,onLinkClick:a}),e.jsx(x,{variant:"tinyRegular",className:"my-xs leading-tight",color:"ultraLight",children:t({defaultMessage:"Streaming links via Reelgood",id:"M0yWt0Lkyu"})})]})})});Ms.displayName="WhereToWatchDetailView";const Ss=g.memo(({item:s,index:a,onLinkClick:t})=>{const l=u.useCallback(()=>t?.(s.source),[s.source,t]);return e.jsxs(Q,{href:s.source,target:"_blank",rel:"noopener",className:"gap-sm hover:bg-offset dark:hover:bg-offsetPlus px-sm py-xs -mx-sm flex cursor-pointer flex-row items-center rounded-md",onClick:l,children:[e.jsxs("div",{className:"relative aspect-square w-6 shrink-0 overflow-hidden rounded-full bg-white",children:[e.jsx("div",{className:"rounded-inherit pointer-events-none absolute inset-0 z-[1] border border-[black]/5 dark:border-[white]/5"}),e.jsx(ce,{hideBorder:!0,size:24,domain:s.source,overrideIconUrl:s.detail,className:"size-full"})]}),e.jsx(x,{variant:"smallBold",color:"light",children:s.value})]},a)});Ss.displayName="WatchOnLinkItem";const Is=g.memo(({watchOn:s,onLinkClick:a})=>e.jsx("div",{className:"gap-x-md grid grid-cols-[repeat(auto-fill,minmax(160px,1fr))]",children:s.map((t,l)=>e.jsx(Ss,{item:t,index:l,onLinkClick:a},l))}));Is.displayName="WatchOnLinkList";const Ps=g.memo(({ratings:s})=>{const{$t:a}=S();return e.jsx("div",{className:"scrollbar-none size-full overflow-y-scroll",children:e.jsxs("div",{className:"p-md pb-sm gap-sm flex flex-col text-left",children:[e.jsx(x,{variant:"smallBold",className:"leading-tight",color:"default",children:a({defaultMessage:"Ratings",id:"XYovs/iySe"})}),s&&s.length>0&&e.jsx("div",{className:"gap-x-md grid grid-cols-[repeat(auto-fill,minmax(160px,1fr))]",children:s.map((t,l)=>{const i=t.value.split(" ")[0],n=t.value.split(" ").slice(1).join(" ");return e.jsxs(Q,{href:ys(t.source),target:"_blank",rel:"noopener nofollow",className:"gap-sm hover:bg-offset dark:hover:bg-offsetPlus px-sm py-xs -mx-sm flex cursor-pointer flex-row items-center rounded-md",children:[e.jsxs("div",{className:"relative aspect-square w-6 shrink-0 overflow-hidden rounded-full bg-white",children:[e.jsx("div",{className:"rounded-inherit pointer-events-none absolute inset-0 z-[1] border border-[black]/5 dark:border-[white]/5"}),e.jsx(ce,{hideBorder:!0,size:24,domain:t.source,overrideIconUrl:t.detail,className:"size-full"})]}),e.jsx(x,{variant:"smallBold",color:"light",className:"truncate",children:n}),e.jsx(x,{variant:"smallBold",color:"light",className:"ml-auto whitespace-nowrap",children:i})]},l)})})]})})});Ps.displayName="RatingsDetailView";const Rs=g.memo(({cast:s,handleAddToFollowup:a})=>{const{$t:t}=S(),l=s?.filter(n=>n.type==="directed_by"),i=s?.filter(n=>n.type==="starring");return e.jsx("div",{className:"scrollbar-none size-full overflow-y-scroll",children:e.jsxs("div",{className:"p-md pb-sm flex flex-col gap-3 text-left",children:[l&&l.length>0&&e.jsxs("div",{className:"flex flex-col",children:[e.jsx(x,{variant:"smallBold",className:"pb-xs leading-tight",color:"default",children:t({defaultMessage:"Directed by",id:"EeQ2D5x1Ub"})}),l.map((n,r)=>e.jsx(Ie,{name:n.value,handleAddToFollowup:a},r))]}),i&&i.length>0&&e.jsxs("div",{className:"flex flex-col",children:[e.jsx(x,{variant:"smallBold",className:"pb-xs leading-tight",color:"default",children:t({defaultMessage:"Cast",id:"2TyWseiGyC"})}),i.map((n,r)=>e.jsx(Ie,{name:n.value,handleAddToFollowup:a},r))]})]})})});Rs.displayName="CastDetailView";const Ie=g.memo(({name:s,handleAddToFollowup:a})=>{const{$t:t}=S(),{isMobileUserAgent:l}=oe(),i=u.useMemo(()=>({maskImage:"linear-gradient(to right, transparent 0%, black 12px, black 100%)"}),[]),n=u.useCallback(()=>a?.(s),[a,s]);return e.jsxs(b,{onClick:n,as:"button",className:k("gap-sm px-sm py-xs -mx-sm group relative flex cursor-pointer flex-row items-center rounded-md",{"hover:bg-offset dark:hover:bg-offsetPlus":!l}),children:[e.jsx(x,{variant:"small",color:"light",className:"leading-tight",children:s}),e.jsx(x,{variant:"tinyRegular",color:"ultraLight",className:k("px-sm pl-md bg-offset dark:bg-offsetPlus absolute right-0 hidden leading-tight",{"group-hover:block":!l}),style:i,children:t({defaultMessage:"Add to follow-up",id:"EgzsNJ7SZP"})})]})});Ie.displayName="CastDetailRow";const ne=g.memo(({title:s,children:a})=>e.jsxs("div",{className:"gap-md mt-4 flex flex-col",children:[e.jsxs("div",{className:"gap-xs flex flex-col",children:[e.jsx(x,{variant:"entry-title-300",children:s}),e.jsx(le,{children:e.jsx("div",{className:"bg-offset my-1 h-4 w-24 rounded-full"})})]}),e.jsx(le,{children:e.jsxs("div",{className:"@container gap-sm mb-2 flex w-full flex-row",children:[e.jsx("div",{className:"bg-offset aspect-[4/3] w-full rounded-xl"}),e.jsx("div",{className:"@[640px]:block bg-offset hidden aspect-[4/3] w-full rounded-xl"}),e.jsx("div",{className:"@[420px]:block bg-offset hidden aspect-[4/3] w-full rounded-xl"})]})}),a]}));ne.displayName="PlaceholderMediumCard";const Es=g.memo(({name:s,knowledgeCard:a,text:t,chunks:l,isLoadingCard:i,isInFlight:n,webResultCitations:r,onCitationClick:o,onQuoteSelect:c})=>{const d=u.useMemo(()=>({answer:t,chunks:l}),[t,l]);return a?e.jsxs(b,{children:[e.jsx(ze,{knowledgeCard:a,handleAddToFollowup:c}),e.jsx(H,{response:d,isPending:n,webResultCitations:r,onCitationClick:o,onQuoteSelect:c})]}):i?e.jsx(ne,{title:s??"",children:e.jsx(H,{response:d,isPending:!0,webResultCitations:r,onCitationClick:o,onQuoteSelect:c})}):e.jsxs("div",{children:[s&&e.jsx(x,{variant:"baseSemi",children:s}),e.jsx(H,{response:d,isPending:n,webResultCitations:r,onCitationClick:o,onQuoteSelect:c})]})});Es.displayName="SmallMovieCard";const Ts=g.memo(({blocks:s,isInFlight:a,webResultCitations:t,onCitationClick:l,onQuoteSelect:i})=>e.jsx("div",{className:"gap-sm py-sm flex flex-col",children:s.map(n=>e.jsx(Es,{knowledgeCard:n.knowledge_card_block?.knowledge_cards[0],isLoadingCard:!!n.awaiting_backfill,name:n.name,text:n.text??"",chunks:n.chunks??Y,isInFlight:a,webResultCitations:t,onCitationClick:l,onQuoteSelect:i},n.name))}));Ts.displayName="MovieCardsList";const Fe=g.memo(({aspectRatio:s="aspect-[4/3]"})=>e.jsxs(le,{children:[e.jsx(I,{fullBleed:!0,className:`${s} relative mb-1.5 w-full overflow-hidden`,children:e.jsx(le,{className:"bg-offset size-full"})}),e.jsx("div",{className:"bg-offset mb-xs h-[16px] w-[240px] rounded-full"}),e.jsx("div",{className:"bg-offset h-[18px] w-[180px] rounded-full"})]}));Fe.displayName="PlaceholderCarouselCard";const As=g.memo(({place:s})=>{const t=Bt({reason:"place-carousel-card"}),l=t.initialized&&t.value?s.canonical_page_path??s.entity_url??s.url:s.entity_url??s.url,{SearchClientLogo:i}=Lt(s.url),n=s.rating||s.price||s.price_range||i,r=u.useCallback(d=>{d.stopPropagation()},[]),o=s.images?.[0]??s.image_url,c=u.useMemo(()=>e.jsx(b,{className:"w-full",children:e.jsx("div",{className:"bg-offset aspect-[4/3] object-cover"})}),[]);return e.jsxs(Q,{className:"gap-xs flex cursor-pointer flex-col items-start",target:"_blank",href:l,children:[e.jsx(I,{fullBleed:!0,className:"relative mb-1.5 aspect-[4/3] w-full overflow-hidden",children:o?e.jsx(se,{includeLightBoxModal:!1,imageClassName:"object-cover aspect-[4/3]",containerClassName:"w-full",src:o,alt:s.name,fallback:c}):e.jsx(b,{className:"w-full",children:e.jsx("div",{className:"bg-offset aspect-[4/3] object-cover"})})}),e.jsx(x,{variant:"smallBold",children:s.name}),!!n&&e.jsx(ie,{className:"gap-xs flex items-center",children:e.jsxs(q,{id:"rating",children:[e.jsx("div",{className:"flex flex-row items-center gap-2",children:e.jsx(ls,{minReviewCount:1,reviewCount:s.num_reviews,rating:s.rating,size:"sm",variant:"truncated",textVariant:"smallBold",reviewTextVariant:"small",color:"default",url:i&&s.url?s.url:void 0})}),!!i&&e.jsx(e.Fragment,{children:s.url?e.jsx(Q,{href:s.url,target:"_blank",className:"cursor-pointer duration-150 hover:opacity-70",onClick:r,children:e.jsx(i,{})}):e.jsx(i,{})})]})})]},s.id)});As.displayName="PlaceCarouselCard";const Ds=g.memo(({places:s})=>e.jsx(gs,{mobileItemsPerPage:2,itemsPerPage:3,navigationVerticalOffset:-24,items:s.map((a,t)=>"id"in a?e.jsx(As,{place:a},a.id):e.jsx(Fe,{},`placeholder-${t}`))}));Ds.displayName="PlaceCardsCarousel";const He=g.memo(({aspectRatio:s="aspect-[4/3]",children:a,title:t})=>e.jsxs("div",{className:"gap-md flex flex-col",children:[t&&e.jsx(x,{variant:"baseSemi",children:t}),e.jsxs("div",{className:"gap-md flex w-full flex-row",children:[e.jsx("div",{className:"w-[180px] shrink-0",children:e.jsx(I,{fullBleed:!0,className:`${s} relative w-full overflow-hidden`,children:e.jsx(le,{className:"bg-offset size-full"})})}),e.jsxs("div",{className:"gap-xs flex flex-col justify-center",children:[a,e.jsx(le,{children:e.jsx("div",{className:"bg-offset my-1 h-4 w-72 rounded-full"})})]})]})]}));He.displayName="PlaceholderSmallCard";const Bs=g.memo(({name:s,place:a,text:t,chunks:l,isInFlight:i,isLoadingCard:n,webResultCitations:r,onCitationClick:o,onQuoteSelect:c})=>{const d=ns(),m=u.useMemo(()=>({answer:t,chunks:l}),[t,l]);return a?e.jsx(fs,{place:a,entryUUID:"",contextUUID:"",inFlight:i,context:d?"medium":"small",children:e.jsx(H,{response:m,isPending:i,webResultCitations:r,onCitationClick:o,onQuoteSelect:c})}):n?d?e.jsx(ne,{title:s??"",children:e.jsx(H,{response:m,isPending:!0,webResultCitations:r,onCitationClick:o,onQuoteSelect:c})}):e.jsx(He,{title:s,children:e.jsx(H,{response:m,isPending:!0,webResultCitations:r,onCitationClick:o,onQuoteSelect:c})}):e.jsxs("div",{children:[s&&e.jsx(x,{variant:"baseSemi",children:s}),e.jsx(H,{response:m,isPending:i,webResultCitations:r,onCitationClick:o,onQuoteSelect:c})]})});Bs.displayName="SmallPlaceCard";const Ls=g.memo(({blocks:s,isInFlight:a,webResultCitations:t,onCitationClick:l,onQuoteSelect:i})=>e.jsx("div",{className:"gap-sm md:gap-lg py-sm md:py-md flex flex-col",children:s.map(n=>e.jsx(Bs,{place:n.place_block,isLoadingCard:!!n.awaiting_backfill,name:n.name,text:n.text??"",chunks:n.chunks??Y,isInFlight:a,webResultCitations:t,onCitationClick:l,onQuoteSelect:i},n.name))}));Ls.displayName="PlaceCardsList";const Ye=8,zs=g.memo(({shoppingWidgets:s})=>{const a="shopping-mode-preview-row",{$t:t}=S(),[l,{width:i}]=te(),{result:{backend_uuid:n}}=F(),{generateShoppingReviewSummary:r,isPending:o}=Le({reason:a}),{isMediumScreen:c}=Te(),d=u.useMemo(()=>ve({targetHeight:150,containerWidth:c?i:768,columnGap:Ye,items:s.map(f=>({width:1,height:1,widget:f}))}),[s,i,c]),m=d.items.reduce((f,v)=>f+v.width,0)+(d.items.length-1)*Ye,p=d.items.length===0||m<i*.8;de("shopping",s.length>0);const h=u.useCallback(f=>{f.review_summary||r({product_name:f.name,merchant_name:f.merchant_info?.merchant_name??"",url:f.url,price:f.price,description:"",entry_uuid:n})},[r,n]);return s?.length?e.jsx("div",{className:"scrollbar-none -mx-md overflow-x-scroll pt-px md:mx-0 md:overflow-x-visible md:pt-0",children:e.jsxs("div",{className:"gap-sm px-md relative flex w-fit flex-row flex-nowrap md:w-full md:px-0",ref:l,children:[d.items.map(f=>{const v=f.item.widget;return e.jsx(Ae,{item:v,inFlight:o,children:e.jsx(Fs,{item:v,width:f.width,imageHeight:d.rowHeight,onItemClick:h})},v.id)}),e.jsx("div",{style:{height:d.rowHeight},className:"pl-md pr-sm pointer-events-none relative flex h-[20vw] min-h-[125px] shrink-0 grow items-center justify-start md:absolute md:right-0 md:top-0 md:z-[1] md:aspect-square md:h-fit md:w-[calc(20%-8px)] md:min-w-0 md:justify-end md:p-0",children:!p&&e.jsx(ue,{tooltipText:t({defaultMessage:"More products",description:"button label",id:"wr457i+zrJ"}),mode:"shopping"})})]})}):null},({shoppingWidgets:s,...a},{shoppingWidgets:t,...l})=>U(a,l)&&W(s,t));zs.displayName="ShoppingModePreviewRow";const Fs=({item:s,width:a,imageHeight:t,aspectRatio:l="aspect-square",onItemClick:i})=>{const{shouldShowBuyWithPro:n,carouselImages:r}=rs(),{setItemDetailsOpen:o}=is(),{trackEvent:c}=O(),{result:{backend_uuid:d,context_uuid:m}}=F(),p=u.useCallback(()=>{c("answer mode carousel item clicked",{answerMode:"shopping",entryUUID:d,contextUUID:m,itemID:s.id}),o(!0),i(s)},[i,s,o,d,m,c]);return e.jsxs(b,{as:"button",onClick:p,className:"gap-sm group flex w-full flex-col md:min-w-0",style:a?{width:a}:void 0,children:[e.jsx(I,{className:`relative w-full overflow-hidden ${l}`,fullBleed:!0,roundedClass:"rounded-lg",style:t?{height:t}:void 0,children:e.jsx(se,{alt:s.name+" logo",src:r[0].src,includeLightBoxModal:!1,containerClassName:"h-full w-full relative overflow-hidden",imageClassName:"absolute w-full h-full object-contain bg-white"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx(x,{variant:"tiny",className:"line-clamp-1 text-left text-black",children:e.jsx("div",{className:"md:group-hover:text-super transition duration-300",children:s.name})}),e.jsxs("div",{className:k("gap-xs flex w-fit flex-row items-center",{"pr-[7px]":n}),children:[e.jsx(Me,{comparePrice:s.variants[0]?.compare_at_price??void 0,price:s.price,size:"small"}),n?e.jsx(zt,{sizeVariant:"small",width:"w-[24px]"}):null]})]})]})},Hs=g.memo(({shoppingWidgets:s})=>{const a="shopping-cards-carousel",{result:{backend_uuid:t}}=F(),{generateShoppingReviewSummary:l,isPending:i}=Le({reason:a}),n=u.useCallback(r=>{r.review_summary||l({product_name:r.name,merchant_name:r.merchant_info?.merchant_name??"",url:r.url,price:r.price,description:"",entry_uuid:t})},[l,t]);return e.jsx(gs,{items:s.map((r,o)=>"id"in r?e.jsx(Ae,{item:r,inFlight:i,children:e.jsx(Fs,{item:r,onItemClick:n},r.id)},r.id):e.jsx(Fe,{aspectRatio:"aspect-square"},`placeholder-${o}`))})});Hs.displayName="ShoppingCardsCarousel";const $s=g.memo(({contextUUID:s,entryUUID:a,item:t,inFlight:l,innerRef:i,className:n,showProsCons:r=!0,handleAddToFollowup:o,context:c,size:d="medium",children:m})=>{const{result:{answer_modes:p}}=F(),h=u.useMemo(()=>p.find(v=>v.answer_mode_type===Ft.SHOPPING)?.shopping_config?.can_try_on??!1,[p]);return e.jsx(Ae,{contextUUID:s,item:t,inFlight:l,entryUUID:a,canTryOn:h,children:e.jsx(Os,{item:t,className:n,contextUUID:s,entryUUID:a,inFlight:l,innerRef:i,showProsCons:r,context:c,handleAddToFollowup:o,size:d,children:m})})});$s.displayName="ShoppingInlineCard";const Os=g.memo(({item:s,contextUUID:a,entryUUID:t,context:l,size:i="medium",children:n})=>{const r="shopping-widget-inner",{inViewRef:o,shouldShowBuyWithPro:c,carouselImages:d,selectedVariant:m,reviewSummaryLoading:p,hasProsOrCons:h}=rs(),[f,v]=u.useState(!1),[_,j]=u.useState(!1),[C,M]=u.useState(0),{setItemDetailsOpen:R}=is(),{trackEvent:E}=O(),N=u.useCallback(()=>{R(!0),E("shopping card body clicked",{productId:s.id,productURL:s.url,contextUUID:a??"",client:s.client}),l==="answersMode"&&E("answer mode tab item selected",{answerMode:"shopping",entryUUID:t??"",contextUUID:a??"",itemID:s.id})},[l,a,t,s.client,s.id,s.url,R,E]),w=u.useCallback(V=>{j(!0),M(V)},[]);Ht({enabled:s.client==="firmly",reason:r});const B=u.useMemo(()=>d.map(V=>V.src),[d]),L=u.useMemo(()=>d.map(V=>({url:V.src,image:V.src})).filter(V=>!!V),[d]),A=u.useCallback(()=>v(!1),[]),G=u.useCallback(()=>v(!0),[]),ae=u.useCallback(()=>j(!1),[]),y=u.useMemo(()=>[typeof s.rating=="number"&&e.jsx(q,{id:"rating",children:e.jsx(ls,{minReviewCount:1,reviewCount:s.num_reviews,rating:s.rating,size:"sm",variant:"truncated",textVariant:"smallBold",reviewTextVariant:"small",color:"default",url:s.url})},"rating"),i==="small"&&e.jsx(q,{id:"buy",children:e.jsxs(b,{className:"gap-sm flex min-h-[24px] shrink-0 flex-row",children:[e.jsx(Me,{textVariant:"smallBold",comparePrice:m?.compare_at_price??void 0,price:s.price,size:"small"}),e.jsx(We,{})]})},"buy")].filter(Boolean),[s.url,s.rating,s.num_reviews,s.price,m?.compare_at_price,i]),K=u.useMemo(()=>e.jsx(x,{color:"light",children:e.jsx(ie,{className:"gap-xs flex flex-row flex-wrap items-center",children:y})}),[y]),J=u.useMemo(()=>[s.merchant_info&&e.jsx(q,{id:"merchant",children:e.jsx($t,{merchantName:s.merchant,merchantDomain:s.merchant_info.merchant_domain,itemUrl:s.url,textVariant:"smallBold",iconSize:"xs"})},"merchant"),c&&e.jsx(q,{id:"free-shipping",children:e.jsx(Ot,{textVariant:"smallBold"})},"free-shipping")].filter(Boolean),[s.merchant_info,s.merchant,s.url,c]),D=u.useMemo(()=>e.jsx(x,{color:"light",children:e.jsx(ie,{className:"gap-xs flex min-h-[24px] flex-row flex-wrap items-center",children:J})}),[J]),z=u.useMemo(()=>e.jsx(x,{color:"light",children:e.jsx(ie,{className:"gap-xs flex flex-row flex-wrap items-center",children:[...y,...J]})}),[y,J]),be=u.useMemo(()=>e.jsx(I,{onMouseEnter:G,onMouseLeave:A,fullBleed:!0,className:"@[420px]:block hidden aspect-[4/3] overflow-hidden !bg-white",children:e.jsx(me,{})}),[G,A]);return i==="small"?e.jsxs(e.Fragment,{children:[e.jsx(Ve,{images:B,showControls:f,onImageClick:w,fillMode:"contain",children:e.jsx(Ca,{image:be,title:s.name,subtitle:K,children:n,footer:D,itemClick:N})}),e.jsx(Ue,{title:s.name,mainImageIndex:C,isOpen:_,images:L,onClose:ae})]}):e.jsxs("div",{ref:o,className:"group relative",children:[e.jsx(Ve,{images:B,showControls:f,onImageClick:w,fillMode:"contain",children:e.jsxs("div",{className:"gap-md @container relative mt-4 flex flex-col","data-testid":"shopping-inline-card-container",children:[e.jsxs("div",{className:"@[420px]:flex-row gap-md flex w-full flex-col items-center",children:[e.jsxs("div",{className:"gap-xs flex w-full flex-col",children:[e.jsx(xs,{title:s.name,onClick:N}),e.jsxs("div",{className:k("gap-xs @[420px]:gap-md @[420px]:flex-row @[420px]:items-end flex flex-col",{"!gap-xs !flex-col !items-start":!h&&d.length<2}),children:[z,e.jsxs(b,{as:"button",onClick:N,className:k("@[420px]:ml-auto gap-sm flex min-h-[24px] shrink-0 flex-row items-end items-center",{"!ml-0":!h&&d.length<2}),children:[e.jsx(Me,{textVariant:"smallBold",comparePrice:m?.compare_at_price??void 0,price:s.price,size:"small"}),e.jsx("div",{className:"!border-super/10 bg-super/10 rounded-[6px] border px-[6px] py-0.5 duration-150",children:e.jsx(We,{})})]})]})]}),!h&&d.length<2?e.jsx(I,{fullBleed:!0,as:"button",onClick:N,className:"@[420px]:w-[128px] @[420px]:ml-auto mb-2 aspect-[4/3] w-full shrink-0 overflow-hidden !bg-white",children:e.jsx("img",{src:d[0].src,alt:s.name,className:"p-xs absolute inset-0 size-full object-contain"})}):null]}),!h&&d.length<2||!d||d.length===0?null:e.jsxs("div",{className:"gap-sm @[420px]:grid-cols-2 @[640px]:grid-cols-3 grid w-full grid-cols-1",children:[d&&d[0]&&e.jsx(I,{onMouseEnter:G,onMouseLeave:A,fullBleed:!0,className:"aspect-[4/3] overflow-hidden !bg-white",children:e.jsx(me,{})}),d&&d[1]&&e.jsx(I,{onMouseEnter:G,onMouseLeave:A,fullBleed:!0,className:"@[640px]:block hidden aspect-[4/3] overflow-hidden !bg-white",children:e.jsx(me,{})}),h?e.jsx("div",{className:k("@[420px]:h-full h-[132px]",{"@[640px]:col-span-2 col-span-1":d&&!d[1]}),children:e.jsx(Ma,{pros:s.review_summary?.pros_detailed??Y,cons:s.review_summary?.cons_detailed??Y,loading:p})}):d&&d[2]?e.jsx(I,{onMouseEnter:G,onMouseLeave:A,fullBleed:!0,className:"@[420px]:block hidden aspect-[4/3] overflow-hidden !bg-white",children:e.jsx(me,{})}):null]}),n]})}),e.jsx(Ue,{title:s.name,mainImageIndex:C,isOpen:_,images:L,onClose:ae})]})});Os.displayName="WidgetInner";const Oa=3,je=g.memo(({block:s,onQuoteSelect:a,children:t,size:l="medium"})=>{const i=Wt(),n="structured-shopping-block",{inFlight:r}=De(),{result:{backend_uuid:o,context_uuid:c}}=F(),{generateShoppingReviewSummary:d,isPending:m}=Le({shouldMutateStore:!1,reason:n}),{data:p}=Ut({queryKey:Ia(s.url??""),queryFn:({queryKey:v})=>i.getQueryData(v)??null,staleTime:1/0}),h=p?.review_summary,f=u.useMemo(()=>{const v=s.review_summary??h;return(v?.pros_detailed?.length||0)+(v?.cons_detailed?.length||0)>=Oa?v:null},[s.review_summary,h]);return u.useEffect(()=>{f||d({product_name:s.name??"",merchant_name:s.merchant??"",url:s.url??"",price:s.price??"",description:"",entry_uuid:o??""})},[o,f]),e.jsx($s,{contextUUID:c,inFlight:r||m,handleAddToFollowup:a,item:{...s,is_card:!1,review_summary:f,object:"ShopifyWidget"},size:l,children:t})},({block:s,...a},{block:t,...l})=>U(a,l)&&W(s,t));je.displayName="StructuredShoppingBlock";const Ws=g.memo(({name:s,shoppingBlock:a,text:t,chunks:l,isLoadingCard:i,isInFlight:n,webResultCitations:r,onCitationClick:o,onQuoteSelect:c})=>{const d=ns(),m=u.useMemo(()=>({answer:t,chunks:l}),[t,l]);return a?e.jsx(je,{block:a,size:d?"medium":"small",children:e.jsx(H,{response:m,isPending:n,webResultCitations:r,onCitationClick:o,onQuoteSelect:c})}):i?d?e.jsx(ne,{title:s??"",children:e.jsx(H,{response:m,isPending:!0,webResultCitations:r,onCitationClick:o,onQuoteSelect:c})}):e.jsx(He,{title:s,children:e.jsx(H,{response:m,isPending:!0,webResultCitations:r,onCitationClick:o,onQuoteSelect:c})}):e.jsxs("div",{children:[s&&e.jsx(x,{variant:"baseSemi",children:s}),e.jsx(H,{response:m,isPending:n,webResultCitations:r,onCitationClick:o,onQuoteSelect:c})]})});Ws.displayName="SmallShoppingCard";const Us=g.memo(({blocks:s,isInFlight:a,webResultCitations:t,onCitationClick:l,onQuoteSelect:i})=>e.jsx("div",{className:"gap-sm md:gap-lg py-sm md:py-md flex flex-col",children:s.map(n=>e.jsx(Ws,{shoppingBlock:n.shopping_block,isLoadingCard:!!n.awaiting_backfill,name:n.name,text:n.text??"",chunks:n.chunks??Y,isInFlight:a,webResultCitations:t,onCitationClick:l,onQuoteSelect:i},n.name))}));Us.displayName="ShoppingCardsList";const Gs=g.memo(({question:s,answer:a,index:t,isFlipped:l,onFlip:i})=>{const{$t:n}=S(),r=u.useCallback(()=>{i()},[i]);return e.jsx("button",{onClick:r,className:k("group relative h-[280px] w-full cursor-pointer transition-transform duration-150"),style:{perspective:"1000px",transformStyle:"preserve-3d"},"aria-label":`Flash card ${t+1}: ${l?"showing answer":"showing question"}`,children:e.jsxs("div",{className:k("absolute inset-0 transition-transform duration-500"),style:{transformStyle:"preserve-3d",transform:l?"rotateY(180deg)":"rotateY(0deg)"},children:[e.jsxs(b,{variant:"raised",className:k("absolute inset-0 flex flex-col items-center justify-center rounded-xl p-6","border-subtlest border","from-background to-offset bg-gradient-to-br"),style:{backfaceVisibility:"hidden"},children:[" ",e.jsx(x,{variant:"small",color:"light",className:"flex-shrink-0",children:n({defaultMessage:"Question",id:"kgOBETYqoW"})}),e.jsx("div",{className:"flex min-h-0 flex-1 flex-col items-center justify-center",children:e.jsx("div",{className:"max-h-full w-full overflow-y-auto px-2",children:e.jsx("div",{className:"py-2 text-center leading-relaxed",children:e.jsx(H,{response:{answer:s,web_results:[]},isPending:!1,embedded:!0,renderCitations:!1,wrapInParent:!1})})})}),e.jsxs(x,{variant:"tiny",color:"light",className:"mt-4 flex flex-shrink-0 items-center gap-1",children:[e.jsx(Se,{className:"size-3"}),n({defaultMessage:"Press to flip",id:"QRWVkKjN0m"})]})]}),e.jsxs(b,{variant:"offset",className:k("absolute inset-0 flex flex-col items-center justify-center rounded-xl p-6","border-super/20 border","from-offset to-offsetPlus bg-gradient-to-br"),style:{transform:"rotateY(180deg)",backfaceVisibility:"hidden"},children:[e.jsx(x,{variant:"small",color:"light",className:"flex-shrink-0",children:n({defaultMessage:"Answer",id:"DwjT1HpUgU"})}),e.jsx("div",{className:"flex min-h-0 flex-1 flex-col items-center justify-center",children:e.jsx("div",{className:"max-h-full w-full overflow-y-auto px-2",children:e.jsx("div",{className:"py-2 text-center leading-relaxed",children:e.jsx(H,{response:{answer:a,web_results:[]},isPending:!1,embedded:!0,renderCitations:!1,wrapInParent:!1})})})}),e.jsxs(x,{variant:"tiny",color:"super",className:"mt-4 flex flex-shrink-0 items-center gap-1",children:[e.jsx(Se,{className:"size-3"}),n({defaultMessage:"Press to flip back",id:"u5D5ZJMqDd"})]})]})]})})});Gs.displayName="FlashCard";const Vs=g.memo(({block:s,className:a,entryUUID:t})=>{xe({assetType:ee.FLASHCARD,entryUUID:t||"",answerMode:"study",reason:"study_mode_flashcard_viewed",skip:!t||!s});const l=s.title||"Flash Cards",i=u.useMemo(()=>s.flash_cards||Y,[s.flash_cards]),[n,r]=u.useState(!1),[o,c]=u.useState(0),d=u.useCallback(()=>{r(h=>!h)},[]),m=u.useCallback(()=>{o<i.length-1&&(c(o+1),r(!1))},[o,i.length]),p=u.useCallback(()=>{o>0&&(c(o-1),r(!1))},[o]);return i.length?e.jsxs(I,{className:k("relative overflow-hidden p-0",a),roundedClass:"rounded-xl",children:[e.jsx("div",{className:"border-subtlest relative border-b p-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(va,{className:"text-super size-5"}),e.jsx(x,{variant:"baseSemi",color:"default",children:l})]})})}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"mb-4 flex items-center justify-between gap-4",children:e.jsx("div",{className:"flex min-w-0 flex-1 justify-center gap-1 overflow-hidden",children:i.map((h,f)=>e.jsx("div",{className:k("h-1 flex-1 rounded-full transition-colors",f===o?"bg-super":f<o?"bg-super/30":"bg-subtler")},f))})}),e.jsx("div",{className:"relative",children:e.jsx(Gs,{question:i[o]?.question||"",answer:i[o]?.answer||"",index:o,isFlipped:n,onFlip:d})}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx(he,{variant:"border",size:"small",onClick:p,disabled:o===0,icon:ja}),e.jsxs(x,{variant:"small",color:"light",className:"min-w-24 flex-shrink-0",children:["Card ",o+1," of ",i.length]}),e.jsx(he,{variant:"border",size:"small",onClick:m,disabled:o===i.length-1,icon:Be})]})]})]}):null});Vs.displayName="FlashCardInlineCard";const qs=g.memo(({block:s,className:a,submitQuery:t,entryUUID:l})=>{const{trackEvent:i}=O(),n=s.question||"",r=u.useMemo(()=>s.levels||Y,[s.levels]),o=s.level_descriptions||Y,[c,d]=u.useState(),m=u.useCallback(p=>{d(p);const h=r[p];i("study mode familiarity level selected",{familiarityLevel:h,familiarityIndex:p,totalLevels:r.length,entryUUID:l}),t&&t({rawQuery:h,querySource:"study-mode",promptSource:"user",collection:null,newFrontendContextUUID:null})},[r,t,i,l]);return e.jsxs(I,{className:k("relative overflow-hidden p-0",a),roundedClass:"rounded-xl",children:[e.jsx("div",{className:"relative p-4",children:e.jsx("div",{className:"relative z-10 flex items-start justify-between",children:e.jsx("div",{className:"gap-xs flex flex-col",children:e.jsx(x,{variant:"baseSemi",color:"default",children:n})})})}),e.jsx("div",{className:"p-4 pt-0",children:e.jsx("div",{className:"gap-sm grid grid-cols-1 md:grid-cols-2",children:r.map((p,h)=>{const f=c===h,v=o?.[h];return e.jsxs(b,{as:"button",onClick:()=>m(h),variant:f?"offset":"transparent",bgHover:"offset",className:k("group relative flex cursor-pointer items-center gap-3 rounded-lg border p-3 text-left transition-all duration-150",{"border-super/30 ring-super/20":f,"border-subtlest hover:border-subtlest":!f}),children:[e.jsxs("div",{className:"flex flex-1 flex-col gap-0.5",children:[e.jsx(x,{variant:"smallBold",color:f?"super":"default",className:"transition-colors duration-150",children:p}),v&&e.jsx(x,{variant:"tiny",color:"light",className:"transition-colors duration-150",children:v})]}),f&&e.jsx("div",{className:"absolute -right-1 -top-1",children:e.jsx("div",{className:"bg-super flex size-5 items-center justify-center rounded-full text-white",children:e.jsx(hs,{className:"size-3"})})})]},h)})})})]})});qs.displayName="GaugeFamiliarityCard";const Ys=u.memo(({block:s,entryUUID:a})=>{const{$t:t}=S(),{isEntryInFlight:l}=F();xe({assetType:ee.QUIZ,entryUUID:a||"",answerMode:"study",reason:"study_mode_quiz_viewed",skip:!a||!s});const i=u.useMemo(()=>s.questions??[],[s]),[n,r]=u.useState(0),[o,c]=u.useState(()=>i.map(()=>({selectedIndex:null,isConfirmed:!1})));u.useEffect(()=>{c(N=>{const w=[...N];for(;w.length<i.length;)w.push({selectedIndex:null,isConfirmed:!1});return w.length>i.length&&w.splice(i.length),w}),r(N=>Math.min(N,Math.max(0,i.length)))},[i.length]);const d=i[n],m=o[n],p=n===i.length-1,h=n===0,f=u.useMemo(()=>l?!1:i.length>0&&o.length===i.length&&o.every(N=>N.isConfirmed)&&n===i.length,[o,i.length,l,n]),v=u.useMemo(()=>f?{correct:o.filter((w,B)=>w.isConfirmed&&w.selectedIndex===i[B]?.correct_answer_index).length,total:i.length}:null,[o,f,i]),_=u.useCallback(N=>{if(m?.isConfirmed||l&&d?.correct_answer_index===void 0)return;const w=[...o];w[n].isConfirmed||(w[n]={selectedIndex:N,isConfirmed:!0},c(w),p&&r(i.length))},[m,o,n,l,d,p,i.length]),j=u.useCallback(()=>{r(N=>Math.max(0,N-1))},[]),C=u.useCallback(()=>{r(N=>Math.min(i.length,N+1))},[i.length]),M=u.useCallback(()=>{c(i.map(()=>({selectedIndex:null,isConfirmed:!1}))),r(0)},[i]),R=u.useMemo(()=>d?.question?d.question:"",[d]),E=u.useCallback(N=>{const w=m?.selectedIndex===N,B=N===d?.correct_answer_index,L=m?.isConfirmed??!1;return k("flex w-full items-center gap-3 rounded-md border p-2 text-sm text-left transition duration-300 ease-out",{"hover:border-super/50":!L,"border-subtlest opacity-60":L&&!(B||w),"border-positive bg-superBG":L&&B,"border-caution !bg-caution/10":L&&(w&&!B),"cursor-not-allowed":L,"cursor-pointer active:scale-[0.97] active:duration-150":!L})},[m,d]);return e.jsxs(b,{variant:"background",className:k("border-subtlest mt-lg relative overflow-hidden rounded-lg border shadow-sm transition-all"),children:[e.jsxs(b,{variant:"offset",className:"p-sm flex items-center justify-between gap-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"flex h-8 w-6 items-center justify-center rounded-full",children:e.jsx($,{icon:ba,size:"sm"})}),e.jsx(x,{variant:"baseSemi",color:"default",children:t({defaultMessage:"Quiz",id:"OuR/Ijtl93"})})]}),!f&&e.jsxs(x,{variant:"tinyMono",color:"light",children:[n+1,"/",i.length,l&&" (Loading...)"]})]}),e.jsxs("div",{className:"p-md",children:[f?f&&v&&e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(b,{variant:"offset",className:"rounded-lg p-4 text-center",children:[e.jsx(x,{variant:"small",color:"light",className:"mb-2",children:t({defaultMessage:"Score",id:"oLkLwwp/v0"})}),e.jsxs(x,{variant:"baseSemi",color:"default",children:[v.correct,"/",v.total]})]}),e.jsxs(b,{variant:"offset",className:"rounded-lg p-4 text-center",children:[e.jsx(x,{variant:"small",color:"light",className:"mb-2",children:t({defaultMessage:"Accuracy",id:"uCsywKWupO"})}),e.jsxs(x,{variant:"baseSemi",color:"default",children:[Math.round(v.correct/v.total*100),"%"]})]})]}),e.jsxs(b,{variant:"background",className:"rounded-lg p-4",children:[e.jsx(x,{variant:"small",color:"light",className:"mb-3",children:t({defaultMessage:"Question Breakdown",id:"iZYHMhEV1M"})}),e.jsx("div",{className:"flex gap-1",children:o.map((N,w)=>{const B=N.selectedIndex===i[w]?.correct_answer_index;return e.jsx(as.div,{className:"flex-1 cursor-pointer py-2",onClick:()=>r(w),whileHover:{scale:1.05,y:-1},whileTap:{scale:.98},title:t({defaultMessage:"Question {index}: {result} (Click to review)",id:"PmL0FsI5U1"},{index:w+1,result:t(B?{defaultMessage:"Correct",id:"6NoIUlkP7d"}:{defaultMessage:"Incorrect",id:"Ypr9T53O9a"})}),children:e.jsx("div",{className:k("h-2 w-full rounded-full transition-all",B?"bg-positive":"bg-caution")})},w)})}),e.jsxs("div",{className:"mt-3 flex justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-positive size-2 rounded-full"}),e.jsx(x,{variant:"tinyRegular",color:"light",children:t({defaultMessage:"Right: {count}",id:"D6wcuVjYnp"},{count:v.correct})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-caution size-2 rounded-full"}),e.jsx(x,{variant:"tinyRegular",color:"light",children:t({defaultMessage:"Wrong: {count}",id:"OFdqHe8jEZ"},{count:v.total-v.correct})})]})]})]})]}):!d&&l?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(x,{variant:"small",color:"light",children:t({defaultMessage:"Loading questions...",id:"j7j2njaKpZ"})})}):d?e.jsxs(e.Fragment,{children:[e.jsx(x,{variant:"base",className:"mb-3 leading-relaxed",children:R}),e.jsx("div",{className:"space-y-2",children:d.options?.map((N,w)=>e.jsxs(b,{variant:"raisedOffset",className:E(w),onClick:()=>_(w),children:[e.jsx(x,{variant:"smallMono",color:"light",className:"flex size-5 items-center justify-center text-xs",children:String.fromCharCode(65+w)}),e.jsx(x,{variant:"small",color:"light",className:"flex-1",children:N}),m?.isConfirmed&&e.jsxs(e.Fragment,{children:[w===d.correct_answer_index&&e.jsx($,{icon:hs,size:"xs",className:"text-positive"}),m.selectedIndex===w&&w!==d.correct_answer_index&&e.jsx($,{icon:pe,size:"xs",className:"text-caution"})]})]},w))})]}):null,e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx("button",{onClick:j,disabled:h&&!f,className:k("flex h-8 items-center gap-1 rounded px-2 transition-all",h&&!f?"cursor-not-allowed opacity-30":"hover:bg-offset"),children:e.jsx($,{icon:wa,size:"xs"})}),f?e.jsxs("button",{onClick:M,className:"bg-super hover:bg-super/90 flex items-center gap-2 rounded-lg px-3 py-1 text-sm font-medium text-white transition-colors",children:[e.jsx($,{icon:Se,size:"xs"}),t({defaultMessage:"Try Again",id:"jsy7pkBETc"})]}):e.jsxs(x,{variant:"small",color:"light",children:[n+1," of ",i.length]}),e.jsx("button",{onClick:C,disabled:f||!m?.isConfirmed,className:k("flex h-8 items-center gap-1 rounded px-2 transition-all",f||!m?.isConfirmed?"cursor-not-allowed opacity-30":"hover:bg-offset"),children:e.jsx($,{icon:ya,size:"xs"})})]})]})]})});Ys.displayName="MultipleChoiceQuestionInlineQuiz";const Ks=g.memo(({videoEntryPoint:s,calendarColor:a,contrastRatio:t,className:l})=>{const{$t:i}=S(),n=u.useCallback(r=>{r.stopPropagation(),window.open(s?.uri,"_blank","noopener,noreferrer")},[s?.uri]);return s?e.jsx("div",{className:k("ease-outExpo absolute right-0 top-1/2 -translate-y-1/2 opacity-0 transition-opacity duration-150 group-hover:opacity-100",l),children:e.jsxs(b,{className:"active:ease-outExpo relative origin-center cursor-pointer overflow-hidden rounded-full px-4 py-2 active:scale-[0.97] active:duration-150",onClick:n,children:[e.jsx("div",{style:{backgroundColor:a},className:k("absolute inset-0 z-0",{"brightness-[0.8]":t==="Fail"})}),e.jsx(x,{variant:"smallBold",color:"white",className:"relative z-[1]",children:i({defaultMessage:"Join Meeting",id:"HK25u5mIfw"})})]})}):null});Ks.displayName="JoinMeetingButton";const Js=g.memo(({startDate:s,endDate:a,showDay:t,isAllDay:l,videoEntryPoint:i,calendarColor:n,contrastRatio:r})=>{const o=u.useMemo(()=>({color:n,opacity:.75}),[n]);return e.jsxs(x,{variant:"tiny",color:"light",className:k("flex flex-row items-center gap-1",{"brightness-[0.8]":r==="Fail"}),style:o,children:[e.jsx(Mt,{startDate:s,endDate:a,isAllDay:l,showDate:t}),i&&e.jsx("span",{children:e.jsx($,{icon:Na,size:"sm"})})]})});Js.displayName="EventTimeDisplay";const Zs=g.memo(({onClick:s,children:a,calendarColor:t,contrastRatio:l})=>e.jsxs(I,{onClick:s,className:"group flex flex-1 cursor-pointer flex-col overflow-hidden !rounded-[4px] !border-none px-4 py-2 pl-6",children:[e.jsx("div",{className:k("pointer-events-none absolute bottom-0 left-0 top-0 w-2",{"brightness-[0.8]":l==="Fail"}),style:{backgroundColor:t}}),e.jsx("div",{className:"ease-outExpo pointer-events-none absolute inset-0 opacity-[0.075] transition-opacity duration-150 group-hover:opacity-15",style:{backgroundColor:t}}),e.jsx("div",{className:"gap-xs relative z-[1] flex flex-col",children:a})]}));Zs.displayName="EventCard";const Xs=g.memo(({event:s,showDay:a=!1})=>{const[t,l]=u.useState(!1),{$t:i}=S(),{title:n,start_date_time:r,end_date_time:o,link:c,is_all_day:d,conference_data:m}=s,p=u.useMemo(()=>new Date(r||""),[r]),h=u.useMemo(()=>new Date(o||""),[o]),f=m?.entry_points?.find(N=>N.entry_point_type==="video"),v=kt(s.calendar_color?.background??"#AC725E"),_=_t(v),j=n&&n.length>1?n:i({defaultMessage:"(No title)",id:"KRdfx1kBlu"}),C=e.jsxs(x,{variant:"section-title",className:"px-sm group-hover:text-super flex flex-row items-center duration-300",children:[j,c&&e.jsx($,{icon:ka,size:"sm"})]}),M=u.useCallback(()=>l(!0),[]),R=u.useCallback(()=>l(!1),[]),E=u.useMemo(()=>({color:v}),[v]);return e.jsxs(e.Fragment,{children:[e.jsxs(Zs,{onClick:M,calendarColor:v,contrastRatio:_,children:[e.jsx(x,{variant:"baseSemi",color:"default",className:k("line-clamp-1",{"brightness-[0.8]":_==="Fail"}),style:E,children:j}),e.jsx(Js,{startDate:p,endDate:h,showDay:a,isAllDay:d??!1,videoEntryPoint:f,calendarColor:v,contrastRatio:_}),e.jsx(Ks,{videoEntryPoint:f,calendarColor:v,contrastRatio:_})]}),e.jsx(Gt,{isOpen:t,variant:"side-sheet",onClose:R,includeBlur:!1,titleContent:c?e.jsx(Q,{href:c,target:"_blank",className:"group",children:C}):C,children:e.jsx(Ct,{event:s,className:"py-2",showRsvp:!0})})]})});Xs.displayName="CalendarEventDense";const Pe=g.memo(({events:s})=>{const a=St(s),t=It(a);return e.jsx("div",{className:"gap-sm flex w-full flex-col",children:a.map((l,i)=>e.jsx(Xs,{event:l,showDay:t},i))})});Pe.displayName="CalendarEventList";const Wa={variant:"border",size:"tiny",pill:!0},Qs=({quote:s})=>s?e.jsx(Q,{href:`/finance/${s.symbol}`,className:"gap-md hover:bg-subtler p-sm -m-sm flex cursor-pointer items-center rounded-md transition-all active:scale-95",children:e.jsxs(b,{className:"gap-xs flex items-center",children:[e.jsx(os,{symbol:s.symbol,src:s.image??"",srcDark:s.imageDark??""}),e.jsxs(b,{children:[e.jsx(b,{className:"gap-sm flex items-center",children:e.jsx(qt,{name:s.name})}),e.jsx(x,{variant:"tinyMono",color:"light",children:e.jsx(Yt,{symbol:s.symbol,exchange:s.exchange})})]})]})}):null,Ua=({quotes:s})=>e.jsx(b,{className:"scrollbar-thin overflow-x-auto",children:e.jsx(b,{className:"gap-md p-sm flex items-center",children:s.map(a=>e.jsx(Qs,{quote:a},a.symbol))})}),Ke=({href:s})=>{const{isMobileStyle:a}=oe();return e.jsx(b,{className:"gap-sm flex items-center justify-center",children:e.jsx(Vt,{hoverOnly:!0,speed:"slow",children:e.jsx(he,{variant:"primaryGhost",chevron:!0,chevronIcon:Be,text:"Deep dive on Perplexity Finance",size:a?"tiny":"small",href:s})})})},Je=({children:s})=>e.jsx(b,{className:"gap-sm p-sm shadow-subtle flex flex-col rounded-xl border",children:s}),Ga=({quotes:s})=>{const a=s[0],t=u.useMemo(()=>s.slice(1).map(i=>i.symbol),[s]);if(!a)return null;const l=a.symbol;return t?.length?e.jsxs(Je,{children:[e.jsx(Ua,{quotes:s}),e.jsx(qe,{symbol:l,search:!0,comparisons:t}),e.jsx(Ke,{href:`/finance/${a?.symbol}?comparing=${t.join(",")}`})]}):e.jsxs(Je,{children:[e.jsxs(b,{className:"p-sm flex items-start justify-between",children:[e.jsx(Qs,{quote:a}),e.jsxs(b,{className:"gap-xs flex items-center",children:[e.jsx(vs,{symbol:l}),e.jsx(js,{symbol:l,buttonProps:Wa})]})]}),e.jsx(Pa,{quote:a}),e.jsx(qe,{symbol:l,search:!1,initialData:a}),e.jsx(I,{className:"px-sm py-md",children:e.jsx(Ra,{quote:a,type:a.exchange})}),e.jsx(Ke,{href:`/finance/${a?.symbol}`})]})};function et(s){switch(s){case"positive":return"super";case"negative":return"red";default:return}}const Va=s=>{switch(s){case"positive":return"+";case"negative":return"-";default:return""}},st=g.memo(({polarity:s,subtitles:a,layout:t="column"})=>{const l=a?.filter(n=>n!=null),{isMobileStyle:i}=oe();return l?.length?e.jsx(x,{variant:t==="row"&&!i?"base":"smallBold",className:k("gap-x-xs flex items-center whitespace-nowrap",t==="row"?"":"mt-two"),color:et(s),children:e.jsxs("span",{children:[Va(s),l.join(" ")]})}):null});st.displayName="Subtitles";const tt=g.memo(({data:s})=>{const{$t:a}=S();return e.jsxs("div",{className:"mt-xs gap-xs flex items-center",children:[e.jsx(x,{variant:"tiny",color:"light",children:a({defaultMessage:"After Hours",id:"unORSkCtYY"})}),e.jsxs(x,{variant:"tiny",color:et(s.polarity)??"light",children:[s.polarity==="positive"?"+":"-",s.absolute," (",s.polarity==="positive"?"+":"-",s.relative,")"]})]})});tt.displayName="AfterHours";const at=g.memo(({wide:s,kicker:a,title:t,subtitles:l=Y,unit:i,polarity:n,afterHours:r,layout:o="column"})=>{const c=e.jsxs(e.Fragment,{children:[a&&e.jsx(x,{variant:"smallCaps",className:"mb-xs truncate",children:a}),e.jsx(x,{as:"span",children:e.jsx("span",{className:"truncate text-xl !leading-none md:text-3xl",children:t})}),i&&e.jsx(x,{variant:"tiny",color:"light",as:"span",className:"whitespace-nowrap !leading-none",children:e.jsx("span",{className:"mx-xs",children:i})})]}),d=r&&e.jsx(tt,{data:r});return e.jsxs("div",{className:k("flex flex-col",{"gap-sm flex items-end":s}),children:[e.jsxs("div",{className:k(o==="row"?"gap-x-xs flex flex-row items-baseline gap-1":""),children:[e.jsx("div",{className:"flex items-baseline",children:c}),e.jsx("div",{className:o==="row"?"flex flex-col justify-end":"",children:e.jsx(st,{subtitles:l,polarity:n,layout:o})})]}),d]})});at.displayName="BigNumberChart";const lt=g.memo(s=>{const a=s.currency,t=a?Ne(s.price,a):s.price,l=s.percentChange?`(${s.percentChange>0?"+":"-"}${Ge(Math.abs(s.percentChange))})`:null,i=s.absoluteChange?a?`${Ne(Math.abs(s.absoluteChange),a)}`:`${s.absoluteChange>0?"+":""}${Math.abs(s.absoluteChange)}`:null,n=s.percentChange===0?"neutral":s.percentChange>0?"positive":"negative",r=u.useMemo(()=>{if(!s.afterHours||s.afterHours.absolute===0&&s.afterHours.relative===0)return;const o=s.afterHours.relative>0?"positive":s.afterHours.relative<0?"negative":"neutral";return{absolute:Ne(Math.abs(s.afterHours.absolute),"usd"),relative:Ge(Math.abs(s.afterHours.relative)/100),polarity:o}},[s.afterHours]);return e.jsx(at,{title:t,kicker:s.kicker,subtitles:[i,l].filter(Boolean),unit:a||"",polarity:n,wide:s.wide,afterHours:r,layout:s.layout})});lt.displayName="BigNumber";const qa=({children:s})=>e.jsx(x,{variant:"micro",color:"light",children:e.jsx("time",{children:s})}),nt=g.memo(s=>{const{$t:a}=S(),[t,l]=u.useState(!1),{data:i,includeLink:n}=s,{quotes:r}=i,o=r?.length>1?a({defaultMessage:"Price Comparison",id:"MFuchsfwj7"}):r[0]?.exchange?`${r[0].exchange}: ${r[0].symbol}`:r[0]?.name,c=u.useMemo(()=>{const d=r.map(f=>f.timestamp).filter(Boolean),m=new Date(Math.max(...d)*1e3),p=new Date().getFullYear()===m.getFullYear(),h=m.toLocaleDateString(void 0,{year:p?void 0:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric",timeZone:"America/New_York",timeZoneName:"short"});return a({defaultMessage:"Updated {time}",id:"0aJxT29U/1"},{time:h})},[r,a]);return u.useEffect(()=>{const d=m=>{m.metaKey&&m.shiftKey&&l(!0)};return document.addEventListener("keydown",d),()=>{document.removeEventListener("keydown",d)}},[]),e.jsx(b,{className:"gap-md p-sm px-md border-b",children:e.jsxs(b,{className:"md:gap-xs flex flex-wrap items-center justify-between",children:[e.jsxs("div",{className:"gap-xs flex items-center",children:[t&&e.jsx(Kt,{shouldAnimate:!1,size:18,className:"[&_path]:!stroke-quiet"}),n&&e.jsxs(e.Fragment,{children:[e.jsxs(Q,{href:"/finance",className:"group relative",children:[e.jsx(b,{variant:"offsetPlus",className:"absolute -inset-x-1.5 inset-y-0 rounded opacity-0 transition-opacity duration-100 group-hover:opacity-100"}),e.jsx(x,{variant:"smallBold",color:"light",className:"group-hover:!text-foreground decoration-subtler relative underline underline-offset-2 duration-100 group-hover:decoration-transparent",children:a({defaultMessage:"Finance",id:"Fm3M+yFIbr"})})]}),e.jsx($,{icon:Be,size:"xs",className:"text-quiet opacity-50"})]}),e.jsx(x,{variant:"smallBold",color:"light",className:"gap-sm flex items-center",as:"h3",children:s?.title??o})]}),e.jsx(b,{className:"gap-sm flex items-center",children:e.jsx(qa,{children:c})})]})})});nt.displayName="Header";const Ya=({dt:s,dd:a,id:t})=>e.jsxs("div",{className:"gap-lg flex flex-row justify-between",children:[e.jsx("dt",{children:e.jsx(x,{as:"h3",variant:"tiny",color:"light",className:"font-normal",children:s})}),e.jsx(x,{as:"dd",color:"light",variant:"tiny",className:"text-right",children:a})]},t),rt=g.memo(({entries:s,gridItems:a,item:t,grid:l})=>{const{$t:i}=S(),n=t??Ya;return e.jsx("dl",{className:"gap-x-lg gap-y-xs grid grid-flow-row grid-cols-2 lg:grid-cols-3",children:l?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden lg:contents",children:a?.map((r,o)=>r?e.jsx(n,{dt:i(ke[r[0]]),dd:r[1],id:`${r[0]}-${r[1]}`},`${r[0]}-${r[1]}`):e.jsx("div",{},`empty-${o}`))}),e.jsx("div",{className:"contents lg:hidden",children:s.map(([r,o])=>e.jsx(n,{dt:i(ke[r]),dd:o,id:`${r}-${o}`},`${r}-${o}`))})]}):s.map(([r,o])=>e.jsx(n,{dt:i(ke[r]),dd:o,id:`${r}-${o}`},`${r}-${o}`))})});rt.displayName="DescriptionList";function Ka({entries:s}){const a=s.some(l=>l.length>2&&l[2]),t=Array(9).fill(null);if(a){const l=s.filter(r=>r.length>2&&r[2]).map(([r,o,c])=>({entry:[r,o],position:c})).sort((r,o)=>r.position[0]!==o.position[0]?r.position[0]-o.position[0]:r.position[1]-o.position[1]),i=new Set,n=(r,o)=>o*3+r;l.forEach(({entry:r,position:o})=>{const[c,d]=o;let m=!1;const p=`${c},${d}`;if(!i.has(p)&&c>=0&&c<3&&d>=0&&d<3){const h=n(c,d);t[h]=r,i.add(p),m=!0}if(!m){for(let h=d+1;h<3&&!m;h++){const f=`${c},${h}`;if(!i.has(f)){const v=n(c,h);t[v]=r,i.add(f),m=!0}}for(let h=c+1;h<3&&!m;h++)for(let f=0;f<3&&!m;f++){const v=`${h},${f}`;if(!i.has(v)){const _=n(h,f);t[_]=r,i.add(v),m=!0}}for(let h=0;h<9&&!m;h++)t[h]===null&&(t[h]=r,m=!0)}});for(let r=0;r<3;r++){const o=[];for(let c=0;c<3;c++){const d=t[n(r,c)];d!==null&&o.push(d)}for(let c=0;c<3;c++)t[n(r,c)]=null;o.forEach((c,d)=>{d<3&&(t[n(r,d)]=c)})}}return{entries:t,reordered:a}}const it=g.memo(({quote:s,currency:a,type:t="DEFAULT",item:l})=>{const{locale:i}=S(),r=u.useMemo(()=>Ta({quote:s,type:t,currency:a,locale:i}),[s,t,a,i]).map(d=>[d.label,d.value]),{entries:o,reordered:c}=u.useMemo(()=>Ka({entries:r}),[r]);return e.jsx(rt,{gridItems:o,entries:r,item:l,grid:c})});it.displayName="QuotesRatiosTable";const ot=g.memo(({quotes:s,currency:a,onHideSymbol:t})=>{const l=S(),i=Jt(),n=s.some(f=>f.volumeChange24h||f.fundingRate),r=Rt({defaultMessage:"Funding Rate data provided by",id:"T/xNz+gPLI"}),o=s[0].name,c=`https://www.coinbase.com/price/${o.toLowerCase().endsWith("usd")?o.slice(0,-3).toLowerCase():o.toLowerCase()}`,d=s.length>0?Ea(s[0].exchange):"DEFAULT",{colorScheme:m}=Zt(),p=u.useMemo(()=>{if(i)return m==="dark"?Xt:Qt},[i,m]),h=u.useCallback(f=>{t?.(f)},[t]);return e.jsxs(b,{className:"mt-sm gap-y-md px-md pb-md pt-sm flex flex-col",children:[s.map((f,v)=>e.jsx(ct,{quote:f,index:v,colors:p,currency:a,handleHideSymbol:h,onHideSymbol:t,quotesLength:s.length,type:d},v)),n&&e.jsx(b,{className:"flex w-full items-center justify-end",children:e.jsx(x,{variant:"tiny",color:"light",children:e.jsxs("span",{className:"font-light",children:[l.formatMessage(r)," ",e.jsx(Q,{href:c,target:"_blank",rel:"noopener",className:"hover:text-super font-normal",children:"Coinbase"})]})})})]})});ot.displayName="CompaniesQuotesRatiosTable";const ct=g.memo(({quote:s,index:a,colors:t,currency:l,handleHideSymbol:i,onHideSymbol:n,quotesLength:r,type:o})=>{const{$t:c}=S(),d=u.useCallback(()=>i(s.symbol),[i,s.symbol]);return e.jsxs("section",{children:[r>1&&e.jsxs(b,{className:"mb-sm pb-sm relative flex items-baseline justify-between border-b",children:[e.jsx(x,{as:"h2",variant:"smallBold",className:k({invisible:r===1}),children:e.jsx("span",{className:"font-mono tracking-wide",children:s.symbol})}),e.jsxs("div",{className:"gap-x-sm flex items-center",children:[s?.timestamp&&e.jsx(x,{variant:"tiny",color:"ultraLight",children:e.jsx("span",{className:"font-normal",children:new Date(s.timestamp*1e3).toLocaleDateString()})}),r>1&&n&&e.jsx(fe,{icon:pe,variant:"common",size:"tiny",pill:!0,onClick:d,toolTip:c({defaultMessage:"Remove",id:"G/yZLul6P1"}),extraCSS:"-mr-sm"})]}),t&&e.jsx("div",{className:"-left-md -top-xs bottom-xs absolute w-[2.5px] -translate-x-px rounded-r-full",style:{backgroundColor:t[a]}})]}),e.jsx(b,{className:k({"mt-sm":r===1}),children:e.jsx(it,{quote:s,currency:l,type:o})})]})});ct.displayName="QuoteSectionFactory";const dt=g.memo(({actionList:s,layoutGroupId:a})=>e.jsx(b,{className:"mx-md border-b",children:e.jsx(ea,{size:"tiny",actionList:s,layoutGroupId:a})}));dt.displayName="TimeWindow";function Ja({children:s}){return e.jsx(I,{shadow:!0,children:s})}const Re=g.memo(s=>{const a="company-stocks",t=s.initialData.history.period,{onHideSymbol:l,hiddenSymbols:i}=s,n=s.initialData.quotes.map(j=>j.symbol),r=u.useMemo(()=>[...n].filter(j=>!i?.includes(j)),[n,i]),{periods:o,scales:c}=Aa({symbols:r,initialPeriod:t}),{data:d,isLoading:m}=Da({symbols:r,period:o.period,initialData:s.initialData,reason:a}),p=Ba(d.quotes,o.period),{isMobileStyle:h}=oe(),f=u.useMemo(()=>o.items.map(j=>({active:j.value===o.period,onClick:j.valid?()=>{o.setPeriod(j.value)}:void 0,show:!0,disabled:!j.valid,valid:j.valid,text:j.text})),[o]),v=u.useMemo(()=>c.items.map(j=>({type:"default",text:j.text,active:j.value===c.scale,onClick:()=>c.setScale(j.value),show:!0,disabled:!1})),[c]),_=u.useMemo(()=>({size:"tiny",pill:!0,variant:"common"}),[]);return e.jsxs(b,{children:[e.jsx(nt,{data:d,title:s.title,includeLink:s.includeLink}),e.jsxs(b,{className:"px-md pt-md pb-sm relative flex justify-between",children:[r.length<4&&e.jsx(b,{className:"gap-x-lg gap-y-md flex flex-wrap",children:d.quotes.map(({symbol:j,price:C,currency:M,name:R})=>{const E=d.changes.find(A=>_e(A.symbol,j)),N=E?.relative[o.period],w=E?.absolute[o.period],B=d.afterHoursChanges.find(A=>_e(A.symbol,j)),L=d.profiles?.find(A=>A.symbol&&_e(A.symbol,j));return M?e.jsxs(b,{className:"flex flex-col",children:[e.jsxs(b,{className:"gap-sm mb-sm flex items-center",children:[e.jsx(os,{symbol:j,src:L?.image??"",srcDark:L?.imageDark??"",className:"!size-4 !p-0"}),e.jsx(x,{variant:"smallBold",className:"flex items-center",children:R})]}),e.jsx(lt,{price:C,percentChange:N*.01,absoluteChange:w,currency:M,afterHours:B,period:o.period,layout:"row"})]},j):null})}),e.jsxs(b,{className:"gap-x-sm top-sm right-sm absolute flex items-center",children:[d.quotes.length===1&&e.jsxs(e.Fragment,{children:[e.jsx(js,{symbol:d.quotes[0].symbol,buttonProps:_}),e.jsx(vs,{symbol:d.quotes[0].symbol})]}),e.jsx(ss,{items:v,isMobileStyle:h,children:e.jsx(fe,{pill:!0,icon:us,size:"tiny"})})]})]}),e.jsx(dt,{actionList:f}),e.jsx("div",{style:{opacity:m?.5:1},children:e.jsx(La,{prices:d.history.prices,usePercentChange:c.scale==="percent",period:o.period,positive:(d.changes?.[0]?.absolute?.[o.period]??0)>=0,previousClose:p,exchangeInfo:d.exchangeInfo??void 0,showAfterHours:d.history.prices.length===1,animate:!1})}),e.jsx(ot,{quotes:d.quotes,currency:d.history.currency,onHideSymbol:l})]})});Re.displayName="CompanyStocks";const ut=g.memo(s=>{const{$t:a}=S(),{canonicalPages:t}=s,[l,i]=u.useState([]),n=u.useMemo(()=>t?[...t].filter(o=>!l.includes(o.id)):[],[t,l]),r=u.useCallback(o=>{i(c=>[...c,o])},[]);return s.canonicalPages?.length?e.jsx(sa,{entries:n.map(({id:o,url_web:c})=>({text:n.length>1?a({defaultMessage:"More about {name}",id:"CnDTF9lORH"},{name:o}):a({defaultMessage:"Deep Dive on Perplexity Finance",id:"PgY5nvmHCw"}),href:c,onClick:()=>s.trackClick(c)})),children:e.jsx(Re,{initialData:s.data,includeLink:!0,onHideSymbol:r,hiddenSymbols:l})}):e.jsx(Ja,{children:e.jsx(Re,{initialData:s.data,includeLink:!0,onHideSymbol:r,hiddenSymbols:l})})});ut.displayName="CompanyStocksWithCta";function Za(s,a){return!!s.data==!!a.data}const Ze=new Set,Xa={finance_prices:g.memo(ut,Za)},Qa=s=>{try{const a=s.data_json?.map(l=>JSON.parse(l)),t=s.data_json_v2?.map(l=>JSON.parse(l));return{v1:a,v2:t}}catch(a){return ps.error("Failed to parse finance widget JSON data",{error:a,data:s}),{v1:[],v2:[]}}},mt=g.memo(({data:s})=>{const{result:{backend_uuid:a,mode:t}}=F(),l=ta(),i=aa(),{v1:n,v2:r}=u.useMemo(()=>Qa(s),[s]);return u.useEffect(()=>{const o=n?.length||r?.length;!a||!o||Ze.has(a)||(l("web.frontend.finance_widgets_render_time",{widgetType:"finance",widgetName:r?.length?"stock_v2":"stock_v1",queryMode:t,widgetSize:"full"}),Ze.add(a))},[n,r,a,t,l,i]),r?.length?e.jsx(Ga,{quotes:r}):n?.length?e.jsx(e.Fragment,{children:n.map(o=>{const c=Xa[o.type];return c?e.jsx(la,{widgetType:"finance",widgetName:o.type,widgetSize:"full",children:({widgetSelected:d})=>e.jsx(c,{data:o.data,canonicalPages:o.canonical_pages,trackClick:d})},o.type):null})}):null});mt.displayName="FinanceWidget";const Xe=8,ht=g.memo(({hotelWidgets:s})=>{const{$t:a}=S(),[t,{width:l}]=te(),{isMediumScreen:i}=Te(),n=u.useMemo(()=>ve({targetHeight:150,containerWidth:i?l:768,columnGap:Xe,items:s?.map(c=>({width:4,height:3,widget:c}))??[]}),[s,l,i]),r=n.items.reduce((c,d)=>c+d.width,0)+(n.items.length-1)*Xe,o=n.items.length===0||r<l*.8;return de("hotels",s&&s.length>0),s?.length?e.jsx("div",{className:"scrollbar-none -mx-md overflow-x-scroll pt-px md:mx-0 md:overflow-x-visible md:pt-0",children:e.jsxs("div",{className:"gap-sm px-md relative flex w-fit flex-row flex-nowrap md:w-full md:px-0",ref:t,children:[n.items.map(c=>{const d=c.item.widget;return e.jsx(el,{place:d,width:c.width,imageHeight:n.rowHeight},c.item.widget.url)}),e.jsx("div",{style:{height:n.rowHeight},className:"pl-md pr-sm pointer-events-none relative flex h-[20vw] min-h-[125px] shrink-0 grow items-center justify-start md:absolute md:right-0 md:top-0 md:z-[1] md:aspect-square md:h-fit md:w-[calc(20%-8px)] md:min-w-0 md:justify-end md:p-0",children:!o&&e.jsx(ue,{tooltipText:a({defaultMessage:"More hotels",id:"kFXpvsdrRb",description:"button label"}),mode:"hotels"})})]})}):null},({hotelWidgets:s,...a},{hotelWidgets:t,...l})=>U(a,l)&&W(s,t));ht.displayName="HotelsModePreviewRow";const el=({place:s,width:a,imageHeight:t})=>{const{trackEvent:l}=O(),i=na(),n=i.initialized&&i.value,{result:{backend_uuid:r,context_uuid:o}}=F();return e.jsxs(b,{as:"button",onClick:()=>{l("answer mode carousel item clicked",{answerMode:"hotels",entryUUID:r,contextUUID:o,itemID:s.id});const c=s.entity_url??s.url,d=n?s.canonical_page_path??c:c;window.open(d,"_blank")},className:"gap-sm group flex flex-col md:min-w-0",style:{width:a},children:[e.jsx(I,{className:"relative w-full overflow-hidden",fullBleed:!0,roundedClass:"rounded-lg",style:{height:t},children:e.jsx(se,{alt:s.name+" logo",src:s.image_url,includeLightBoxModal:!1,containerClassName:"h-full w-full relative overflow-hidden",imageClassName:"absolute w-full h-full object-cover bg-white"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx(x,{variant:"tiny",className:"line-clamp-1 text-left text-black",children:e.jsx("div",{className:"md:group-hover:text-super transition duration-300",children:s.name})}),(s.price||s.price_range)&&e.jsx("div",{className:"gap-xs flex w-fit flex-row items-center",children:e.jsx(cs,{dollarCount:s.price?.replace(/\u200A/g,"").length??0,priceRange:s.price_range})})]})]})},xt=g.memo(({jobsWidgets:s})=>{const{$t:a}=S(),t=s.slice(0,3);return de("jobs",t.length>0),t.length===0?null:e.jsxs("div",{className:"gap-sm scrollbar-none px-md -mx-md relative flex flex-row overflow-x-scroll md:mx-0 md:overflow-x-visible md:px-0",children:[e.jsx("div",{className:"gap-sm relative flex shrink-0 flex-row flex-nowrap md:w-full",children:t.map(l=>e.jsx(sl,{job:l,url:l.url},l.id))}),e.jsx("div",{className:"pl-md pr-sm pointer-events-none relative z-[1] flex items-center justify-end md:absolute md:inset-0 md:px-0",children:e.jsx(ue,{tooltipText:a({defaultMessage:"More jobs",description:"button label",id:"/tzvlTQopt"}),mode:"jobs"})})]})},({jobsWidgets:s,...a},{jobsWidgets:t,...l})=>U(a,l)&&W(s,t));xt.displayName="JobsModePreviewRow";const sl=({job:s,url:a})=>{const{locale:t}=S(),l=ra(),i=new Date(s.posted_at),{trackEvent:n}=O(),{result:{backend_uuid:r,context_uuid:o}}=F(),c=s.labels?.find(d=>d.type==="compensation");return e.jsxs(I,{className:"p-sm group relative flex min-h-[128px] w-[40vw] min-w-[220px] flex-col items-start md:w-full md:min-w-0",as:"button",onClick:()=>{n("answer mode carousel item clicked",{answerMode:"jobs",entryUUID:r,contextUUID:o,itemID:s.id}),window.open(a,"_blank")},roundedClass:"rounded-lg",children:[e.jsxs("div",{className:"bg-offset dark:bg-offsetPlus relative flex size-[32px] shrink-0 items-center justify-center overflow-hidden rounded-full",children:[s.logo_url&&s.logo_url.length>0?e.jsx(se,{alt:s.company,containerClassName:"absolute inset-0",imageClassName:"size-full object-contain bg-white [overflow-clip-margin:unset]",src:s.logo_url,includeLightBoxModal:!1}):e.jsx(x,{color:"light",children:e.jsx($,{size:16,icon:_a})}),e.jsx("div",{className:"rounded-inherit absolute inset-0 border border-[black]/5 dark:border-transparent"})]}),e.jsxs("div",{className:"p-xs mt-auto flex w-full flex-col items-start text-left",children:[e.jsx(x,{variant:"tinyRegular",color:"light",className:"line-clamp-1",children:s.company}),e.jsx(x,{variant:"tiny",color:"default",className:"md:group-hover:text-super line-clamp-2 transition duration-300",children:s.title_clean}),c?e.jsx(x,{variant:"tinyRegular",color:"light",children:c.label}):e.jsx(za,{timestamp:i.toISOString(),translations:l,locale:t,textVariant:"tinyRegular",textColor:"light",style:"long",hideIcon:!0})]})]})},tl=({knowledgeCard:s,entryUUID:a,isReadonly:t=!0,isEntryInFlight:l=!1,submitQuery:i})=>{const n="person-preview-row",{$t:r}=S(),{trackEvent:o}=O(),{removeWidgetFromEntry:c}=ia({reason:n}),d=u.useCallback(()=>{if(a&&s){const p={...s,url:s.links?.[0]?.url||""};c({entryUUID:a,data:p}),o("remove widget",{url:p.url,entryUUID:a,source:"thread"})}},[a,s,c,o]);if(!s)return null;const m=t||l?[]:[{type:"default",text:r({defaultMessage:"Report",id:"x5Tz6MZH82"}),icon:ds,onClick:d}];return e.jsx(oa,{knowledgePanelData:s,summaryData:null,submit:i,isReadonly:t,menuItems:m,entryUUID:a||"",className:"mb-0"})},Qe=8,ft=g.memo(({placeWidgets:s})=>{const{$t:a}=S(),[t,{width:l}]=te(),{isMediumScreen:i}=Te(),n=u.useMemo(()=>ve({targetHeight:150,containerWidth:i?l:768,columnGap:Qe,items:s?.map(c=>({width:4,height:3,widget:c}))??[]}),[s,l,i]),r=n.items.reduce((c,d)=>c+d.width,0)+(n.items.length-1)*Qe,o=n.items.length===0||r<l*.8;return de("places",s&&s.length>0),s?.length?e.jsx("div",{className:"scrollbar-none -mx-md overflow-x-scroll pt-px md:mx-0 md:overflow-x-visible md:pt-0",children:e.jsxs("div",{className:"gap-sm px-md relative flex w-fit flex-row flex-nowrap md:w-full md:px-0",ref:t,children:[n.items.map(c=>{const d=c.item.widget;return e.jsx(al,{place:d,width:c.width,imageHeight:n.rowHeight},c.item.widget.url)}),e.jsx("div",{style:{height:n.rowHeight},className:"pl-md pr-sm pointer-events-none relative flex h-[20vw] min-h-[125px] shrink-0 grow items-center justify-start md:absolute md:right-0 md:top-0 md:z-[1] md:aspect-square md:h-fit md:w-[calc(20%-8px)] md:min-w-0 md:justify-end md:p-0",children:!o&&e.jsx(ue,{tooltipText:a({defaultMessage:"More places",id:"TMrvhLUICq",description:"button label"}),mode:"places"})})]})}):null},({placeWidgets:s,...a},{placeWidgets:t,...l})=>U(a,l)&&W(s,t));ft.displayName="PlacesModePreviewRow";const al=({place:s,width:a,imageHeight:t})=>{const{trackEvent:l}=O(),{result:{backend_uuid:i,context_uuid:n}}=F();return e.jsxs(b,{as:"button",onClick:()=>{l("answer mode carousel item clicked",{answerMode:"places",entryUUID:i,contextUUID:n,itemID:s.id});const r=s.entity_url??s.url;window.open(r,"_blank")},className:"gap-sm group flex flex-col md:min-w-0",style:{width:a},children:[e.jsx(I,{className:"relative w-full overflow-hidden",fullBleed:!0,roundedClass:"rounded-lg",style:{height:t},children:e.jsx(se,{alt:s.name+" logo",src:s.image_url,includeLightBoxModal:!1,containerClassName:"h-full w-full relative overflow-hidden",imageClassName:"absolute w-full h-full object-cover bg-white"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx(x,{variant:"tiny",className:"line-clamp-1 text-left text-black",children:e.jsx("div",{className:"md:group-hover:text-super transition duration-300",children:s.name})}),(s.price||s.price_range)&&e.jsx("div",{className:"gap-xs flex w-fit flex-row items-center",children:e.jsx(cs,{dollarCount:s.price?.replace(/\u200A/g,"").length??0,priceRange:s.price_range,currencySymbol:s.currency_char})})]})]})},ll=g.memo(({image:s,isLoading:a=!0})=>{const{$t:t}=S(),{result:{backend_uuid:l}}=F(),i=s?.status===ca.FAILED,n=s?.image;return xe({assetType:ee.GENERATED_IMAGE,entryUUID:l??"",answerMode:"search",reason:"single-image-display"}),s?e.jsx("div",{className:"@container min-w-[280px] max-w-[calc(100vh-360px)] [@media(max-width:768px)]:max-w-full [@media(min-height:1100px)]:max-w-full",children:e.jsx(b,{variant:"raised",className:"shadow-overlay relative flex aspect-square w-full items-center justify-center overflow-hidden rounded-xl p-3",children:e.jsx("div",{className:"relative w-full",children:i?e.jsx(b,{variant:"offset",className:"flex aspect-square size-full items-center justify-center rounded-md",children:e.jsx(x,{variant:"baseSemi",color:"ultraLight",className:"text-center",children:t({defaultMessage:"Failed to generate image",id:"mVJ5f5LkYT"})})}):e.jsx("div",{className:"aspect-square w-full",children:e.jsx(da,{sourceImage:n,media:s,generating:a,type:"image"})})})})}):null},({image:s,...a},{image:t,...l})=>U(a,l)&&W(s,t)),nl=120,Ce=8,pt=g.memo(({className:s,isLoading:a,videos:t})=>{const{$t:l}=S(),[i,{width:n}]=te(),{result:{backend_uuid:r,context_uuid:o}}=F(),[c,d]=u.useState(!1),[m,p]=u.useState(void 0),h=u.useMemo(()=>{if(n===0)return{items:[],rowHeight:0};const j=t.map(M=>({id:M.name,title:M.name,thumbnail:M.thumbnail,videoUrl:M.url,isLoading:!1,width:16,height:9}));return ve({targetHeight:nl,containerWidth:n,columnGap:Ce,items:a?[{width:16,height:9},{width:16,height:9},{width:16,height:9}]:j,stretchLastToFit:!1})},[n,a,t]),f=h.items.reduce((j,C)=>j+C.width,0)+(h.items.length-1)*Ce,v=a||h.items.length===0||f<n*.8,{trackEvent:_}=O();return de("videos"),e.jsxs("div",{className:k("gap-sm scrollbar-none px-md -mx-md relative flex flex-row overflow-x-scroll md:mx-0 md:overflow-x-visible md:px-0",s),children:[e.jsxs("div",{className:"relative w-[120vw] shrink-0 md:w-full",children:[e.jsx("div",{ref:i,className:"flex w-full",style:{gap:Ce},children:h.items.map(({width:j,item:C},M)=>{if(!("id"in C)||a)return e.jsx(b,{variant:"offset",className:"bg-offset relative overflow-hidden rounded-xl",style:{width:j,aspectRatio:C.width/C.height}},M);const R=C;return e.jsxs(I,{as:"button",fullBleed:!0,onClick:()=>{_("answer mode carousel item clicked",{answerMode:"videos",entryUUID:r,contextUUID:o,itemID:R.id}),d(!0),p(R.videoUrl)},className:"group relative overflow-hidden",style:{height:h.rowHeight,width:j,aspectRatio:R.width==null||R.height==null?"16 / 9":void 0},roundedClass:"rounded-lg",children:[e.jsx("img",{src:R.thumbnail,alt:R.title+" trailer",className:"absolute inset-0 size-full object-cover"}),e.jsx("div",{className:"p-sm absolute inset-x-0 top-0 bg-gradient-to-b from-black/60 to-transparent opacity-0 transition-opacity duration-200 group-hover:opacity-100",children:e.jsx(x,{variant:"smallBold",color:"white",className:"line-clamp-1 text-left",children:R.title})}),e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent"}),e.jsx("div",{className:"relative flex size-12 items-center justify-center rounded-full bg-black/50 backdrop-blur-sm backdrop-saturate-200",children:e.jsx(x,{variant:"smallBold",color:"white",className:"group-active:opacity-70",children:e.jsx($,{icon:ms})})})]})]},R.id)})}),!v&&e.jsx("div",{className:"pl-md pr-sm pointer-events-none relative z-[1] flex items-center justify-end md:absolute md:inset-0 md:px-0",children:e.jsx(ue,{tooltipText:l({defaultMessage:"More videos",description:"button label",id:"OVdhnfNu+r"}),mode:"videos"})})]}),e.jsx(ts,{isOpen:c,setisOpen:d,url:m||"",name:"Sample Video"})]})},({videos:s,...a},{videos:t,...l})=>U(a,l)&&W(s,t));pt.displayName="VideoModePreviewRow";function rl({data:s,entryUUID:a}){const t=ua(),{trackEventOnce:l,trackEvent:i}=O(),{$t:n}=S(),[r,o]=u.useState(!1);u.useEffect(()=>{a&&l("pro perk contextual offer shown",{isPro:t.hasAccessToProFeatures,entryUUID:a,partner:s.partner})},[a,t.hasAccessToProFeatures,s.partner,l]);const c=u.useCallback(()=>{o(!0),a&&i("pro perk contextual offer dismissed",{isPro:t.hasAccessToProFeatures,entryUUID:a,partner:s.partner})},[a,t.hasAccessToProFeatures,s.partner,i]),d=u.useCallback(()=>{a&&i("pro perk contextual offer clicked",{isPro:t.hasAccessToProFeatures,entryUUID:a,partner:s.partner})},[a,t.hasAccessToProFeatures,s.partner,i]);return r?null:e.jsxs("div",{className:"p-md gap-md bg-offset flex items-center justify-between rounded-lg",children:[e.jsxs("div",{className:"gap-md flex items-center",children:[e.jsx(ce,{className:"rounded-md",size:32,domain:s.url}),e.jsxs("div",{children:[e.jsx(x,{variant:"smallBold",children:s.offer}),e.jsx(x,{variant:"small",color:"light",children:n({defaultMessage:"Upgrading gives you access to exclusive partner deals.",id:"lvjA6iwB4x"})})]})]}),e.jsxs("div",{className:"gap-md flex items-center",children:[e.jsx(he,{text:n({defaultMessage:"Learn more",id:"TdTXXf940t"}),onClick:d,href:`/account/pro-perks/${s.partner.toLowerCase()}`}),e.jsx(fe,{onClick:c,icon:pe})]})]})}function il(){const{value:s}=ma({flag:"enable-inline-structured-tables",subjectType:"user_nextauth_id",defaultValue:!1});return s}var ol={};const P=g.memo(({children:s,className:a})=>e.jsx("div",{className:`first:-mt-sm mb-4 mt-5 ${a||""}`,children:s}));P.displayName="StructuredBlockWrapper";const cl=s=>!!s.text||!!s.chunks?.length||!!s.entities?.length;function dl(s){const{hasFastWidget:a,isSidecar:t,inProgress:l}=s;return!!(a||t&&l)}function ul(s){return s.medium==="video"&&s.source!=="youtube"}const $e=g.memo(({block:s,onQuoteSelect:a})=>{const{inFlight:t}=De(),{result:{backend_uuid:l,context_uuid:i}}=F(),n=u.useMemo(()=>({...s,object:"PlaceWidget"}),[s]);return e.jsx(fs,{inFlight:t,entryUUID:l,contextUUID:i,place:n,handleAddToFollowup:a})},({block:s,...a},{block:t,...l})=>U(a,l)&&W(s,t));$e.displayName="StructuredPlaceBlock";const gt=g.memo(({csvContent:s})=>{const a=u.useMemo(()=>{const t=s.split(`
`),l=t[0].split(","),i=[];for(let n=1;n<t.length;n++){if(!t[n])continue;const r={},o=t[n].split(",");for(let c=0;c<l.length;c++)r[l[c]]=o[c];i.push(r)}return i},[s]);return e.jsx(fa,{data:a})});gt.displayName="StructuredCsvTable";const vt=g.memo(({entityGroupV2Block:s,onCitationClick:a,onQuoteSelect:t})=>{const{isEntryInFlight:l,webResultCitations:i}=F();return ge(s.entity_group_type).with(X.PLACE_CARD,()=>e.jsx(Ls,{blocks:s.entities,isInFlight:l,webResultCitations:i,onCitationClick:a,onQuoteSelect:t})).with(X.SHOPPING_CARD,()=>e.jsx(Us,{blocks:s.entities,isInFlight:l,webResultCitations:i,onCitationClick:a,onQuoteSelect:t})).with(X.MOVIE_TV_CARD,()=>e.jsx(Ts,{blocks:s.entities,isInFlight:l,webResultCitations:i,onCitationClick:a,onQuoteSelect:t})).otherwise(()=>null)});vt.displayName="StructuredAnswerEntityGroupV2Block";const Ee=g.memo(({entityGroupBlock:s})=>ge(s.entity_group_type).with(X.CALENDAR_EVENT,()=>{const a=s.entities.map(t=>t.calendar_event_block?.calendar_event).filter(t=>!!t);return e.jsx(Pe,{events:a})}).with(X.PLACE_CARD,()=>{const a=s.entities.map(t=>t.place_block||t.placeholder_block).filter(t=>!!t);return e.jsx(Ds,{places:a})}).with(X.SHOPPING_CARD,()=>{const a=s.entities.map(t=>t.shopping_block||t.placeholder_block).filter(t=>!!t);return e.jsx(Hs,{shoppingWidgets:a})}).with(X.CALENDAR_ACTION,()=>{const a=s.entities.map(o=>o.calendar_event_block).filter(o=>o!=null&&o.calendar_event!==null&&o.calendar_event!==void 0);if(a.length===0)return null;if(a.length>1){const o=a.map(c=>c.calendar_event);return e.jsx(Pe,{events:o})}const t=a[0],l=t.calendar_event,i=t.old_calendar_event,n=i?l:void 0,r=i??l;return r&&e.jsx(es,{event:r,newEvent:n,truncateAttendees:2,isEditable:!1,action:t.action})}).otherwise(()=>null),({entityGroupBlock:s,...a},{entityGroupBlock:t,...l})=>U(a,l)&&W(s,t));Ee.displayName="StructuredAnswerEntityGroupBlock";const jt=g.memo(({entityListBlock:s,onQuoteSelect:a})=>{const{inFlight:t}=De(),l=pa(),i=u.useMemo(()=>({answer:s.text,chunks:s.chunks}),[s.text,s.chunks]);return e.jsxs(e.Fragment,{children:[(s.text||s.chunks)&&e.jsx(H,{response:i,isPending:t,enableCitationGrouping:l}),s.entities.map(n=>e.jsxs("div",{className:"flex flex-col gap-y-2",children:[ge(n).with({place_block:T.nonNullable},({place_block:r})=>e.jsx($e,{block:r,onQuoteSelect:a})).with({shopping_block:T.nonNullable},({shopping_block:r})=>e.jsx(je,{onQuoteSelect:a,block:r})).with({awaiting_backfill:!0},()=>e.jsx(ne,{title:n.title})).otherwise(()=>e.jsx("div",{className:"mt-4",children:e.jsx(x,{variant:"entry-title-300",children:n.title})})),(n.text||n.chunks)&&e.jsx(H,{response:{answer:n.text,chunks:n.chunks},isPending:t,enableCitationGrouping:l})]},`entity-list-${n.index}`))]})},({entityListBlock:s,...a},{entityListBlock:t,...l})=>U(a,l)&&W(s,t));jt.displayName="StructuredAnswerEntityListBlock";const bt=g.memo(({block:s,submitQuery:a,onQuoteSelect:t})=>{const{isEntryInFlight:l,result:{backend_uuid:i}}=F(),n=xa();return s.knowledge_cards[0].card_type==="MOVIE"?e.jsx(ze,{knowledgeCard:s.knowledge_cards[0],handleAddToFollowup:t,entryUUID:i}):e.jsx(tl,{isReadonly:n,isEntryInFlight:l,submitQuery:a,knowledgeCard:s.knowledge_cards[0],entryUUID:i})},({block:s,...a},{block:t,...l})=>U(a,l)&&W(s,t));bt.displayName="StructuredKnowledgeCardBlock";const wt=g.memo(({block:s})=>{const{result:{backend_uuid:a}}=F();return e.jsx(rl,{data:s,entryUUID:a})},({block:s,...a},{block:t,...l})=>U(a,l)&&W(s,t));wt.displayName="StructuredAnswerProPerkOfferBlock";const ml=g.memo(({block:s,submitQuery:a,onQuoteSelect:t,disableInteractions:l=!1,onCitationClick:i})=>{const{searchMode:n,hasMediaOnlyLayout:r,hasFastWidget:o,result:{backend_uuid:c}}=F(),d=il();return ge(s).with({inline_entity_block:{knowledge_card_block:T.nonNullable}},({inline_entity_block:m})=>e.jsx(P,{children:e.jsx(bt,{block:m.knowledge_card_block,submitQuery:a,onQuoteSelect:t})})).with({inline_entity_block:{place_block:T.nonNullable}},({inline_entity_block:m})=>e.jsx(P,{children:e.jsx($e,{block:m.place_block,onQuoteSelect:t})})).with({inline_entity_block:{shopping_block:T.nonNullable}},({inline_entity_block:m})=>e.jsx(P,{children:e.jsx(je,{block:m.shopping_block,onQuoteSelect:t})})).with({inline_entity_block:{placeholder_block:T.nonNullable}},({inline_entity_block:m})=>e.jsx(P,{children:e.jsx(ne,{title:m.placeholder_block.title})})).with({inline_entity_block:{media_block:T.nonNullable}},({inline_entity_block:m})=>{const p=m.media_block,h=r,f=p.generated_media_items?.[0];if(n===Z.SEARCH&&f&&s.intended_usage==="answer_generated_image")return e.jsx(P,{children:e.jsx(ll,{image:f,isLoading:f.status==="IN_PROGRESS"})});if(n===Z.SEARCH&&f&&s.intended_usage==="answer_generated_video"){const _={url:f.url};return e.jsx(P,{children:e.jsx(Oe,{generated_video:_,mediaItem:f,entryUUID:c})})}if(h)return null;const v=p.media_items;if(v&&v.length===1){const _=v[0];if(ul(_)){const j={url:_.url};return e.jsx(P,{children:e.jsx(Oe,{generated_video:j,mediaItem:f,entryUUID:c})})}if(_.image)return e.jsx(P,{children:e.jsx(ws,{image:v[0],searchMode:n,entryUUID:c})})}if(p&&s.intended_usage==="answer_media_items"&&!l){const _=p.progress===ha.IN_PROGRESS;if(dl({hasFastWidget:o,isSidecar:!!ol.NEXT_PUBLIC_IS_SIDECAR_BUILD,inProgress:_}))return null;const j=p.media_items.filter(M=>M.medium==="video"),C=p.media_items.filter(M=>M.medium==="image");if(j.length>0)return e.jsx(P,{children:e.jsx(pt,{videos:j,isLoading:_})});if(C.length>0)return e.jsx(P,{children:e.jsx(Sa,{images:C,isLoading:_})})}return null}).with({inline_entity_block:{jobs_preview_block:T.nonNullable}},({inline_entity_block:m})=>e.jsx(P,{children:e.jsx(xt,{jobsWidgets:m.jobs_preview_block.jobs_widgets})})).with({inline_entity_block:{shopping_preview_block:T.nonNullable}},({inline_entity_block:m})=>n===Z.RESEARCH?null:e.jsx(P,{children:e.jsx(zs,{shoppingWidgets:m.shopping_preview_block.shopping_widgets})})).with({inline_entity_block:{hotels_preview_block:T.nonNullable}},({inline_entity_block:m})=>n===Z.RESEARCH?null:e.jsx(P,{children:e.jsx(ht,{hotelWidgets:m.hotels_preview_block.place_widgets})})).with({inline_entity_block:{places_preview_block:T.nonNullable}},({inline_entity_block:m})=>n===Z.RESEARCH?null:e.jsx(P,{children:e.jsx(ft,{placeWidgets:m.places_preview_block.place_widgets})})).with({inline_entity_block:{calendar_event_block:T.nonNullable}},({inline_entity_block:m})=>{const p=m.calendar_event_block,h=p.calendar_event;return h?e.jsx("div",{className:"my-4",children:e.jsx(es,{event:h,truncateAttendees:2,isEditable:!1,action:p.action})}):null}).with({inline_entity_block:{assets_preview_block:T.nonNullable}},({inline_entity_block:m})=>{const h=m.assets_preview_block.assets.findLast(f=>f.app);if(h?.app&&h.app.url){const f={url:h.app.url,app_url:h.app.app_url,name:h.app.name,description:h.app.description};return e.jsx(P,{children:e.jsx(Fa,{app:f,entryUuid:c,assetUUID:h.uuid})})}return null}).with({inline_entity_block:{assets_inline_block:T.nonNullable}},({inline_entity_block:m})=>{const h=m.assets_inline_block.assets[0];return h?h.code_file?.mime_type==="text/csv"&&d?e.jsx(P,{className:"mt-md",children:e.jsx(gt,{csvContent:h.code_file.content})}):e.jsx(P,{className:"mt-md",children:e.jsx(Pt,{asset:h},h.uuid)}):null}).with({entity_list_block:T.when(m=>m!==void 0&&cl(m))},({entity_list_block:m})=>e.jsx(jt,{entityListBlock:m,onQuoteSelect:t})).with({entity_group_block:T.nonNullable},({entity_group_block:m})=>m.entity_group_type===X.CALENDAR_EVENT?e.jsx("div",{className:"my-4",children:e.jsx(Ee,{entityGroupBlock:m})}):e.jsx(P,{children:e.jsx(Ee,{entityGroupBlock:m})})).with({entity_group_v2_block:T.nonNullable},({entity_group_v2_block:m})=>e.jsxs(P,{children:[m.title&&e.jsx(x,{variant:"section-title",children:m.title}),e.jsx(vt,{entityGroupV2Block:m,onCitationClick:i,onQuoteSelect:t})]})).with({pro_perk_offer_block:T.nonNullable},({pro_perk_offer_block:m})=>e.jsx(P,{children:e.jsx(wt,{block:m})})).with({inline_entity_block:{finance_inline_block:T.nonNullable}},({inline_entity_block:m})=>e.jsx(P,{children:e.jsx(mt,{data:m?.finance_inline_block})})).with({inline_entity_block:{gauge_familiarity_card_block:T.nonNullable}},({inline_entity_block:m})=>e.jsx(P,{children:e.jsx(qs,{block:m.gauge_familiarity_card_block,submitQuery:a,entryUUID:c})})).with({inline_entity_block:{multiple_choice_quiz_card_block:T.nonNullable}},({inline_entity_block:m})=>{const p=m.multiple_choice_quiz_card_block.title||"quiz",h=`${c}-${p}`;return e.jsx(P,{children:e.jsx(Ys,{block:m.multiple_choice_quiz_card_block,contentId:h,entryUUID:c})})}).with({inline_entity_block:{flash_card_section_block:T.nonNullable}},({inline_entity_block:m})=>e.jsx(Vs,{block:m.flash_card_section_block,entryUUID:c})).otherwise(()=>(ps.debug(new Error("No StructuredAnswerInlineBlock render method found for block"),{extra:{block:s}}),null))});ml.displayName="StructuredAnswerInlineBlock";export{ml as S,ul as i,Ha as u};
//# sourceMappingURL=StructuredAnswerInlineBlock-9sWHUlsm.js.map
